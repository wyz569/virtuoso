
<html><head><title>Comparator Macromodel</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="smeghna" />
<meta name="CreateDate" content="2023-10-03" />
<meta name="CreateTime" content="1696331122" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the Functional Block Library which is a library within the Cadence analog design enviroment and is used by analog designers as a high-level design tool" />
<meta name="DocTitle" content="Virtuoso Functional Block Library Reference" />
<meta name="DocType" content="Reference" />
<meta name="FileTitle" content="Comparator Macromodel" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="fblocklibref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-10-03" />
<meta name="ModifiedTime" content="1696331122" />
<meta name="NextFile" content="appA_re_Uses_of_the_Comparator_Macromodel.html" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="chap1.html" />
<meta name="c_product" content="Virtuoso Analog Design Environment" />
<meta name="Product" content="Virtuoso Analog Design Environment" />
<meta name="ProductFamily" content="Virtuoso Analog Design Environment" />
<meta name="ProductVersion" content="IC23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Virtuoso Functional Block Library Reference -- Comparator Macromodel" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="IC23.1" />
<meta name="SpaceKey" content="fblocklibrefIC231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="fblocklibrefTOC.html">Contents</a></li><li><a class="prev" href="chap1.html" title="Introduction to Functional Block Library">Introduction to Functional Blo ...</a></li><li style="float: right;"><a class="viewPrint" href="fblocklibref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="appA_re_Uses_of_the_Comparator_Macromodel.html" title="Uses of the Comparator Macromodel">Uses of the Comparator Macromo ...</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Virtuoso Functional Block Library Reference<br />Product Version IC23.1, November 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>A
<a id="pgfId-919892"></a></h1>
<h1>
<a id="pgfId-919894"></a><hr />
<a id="33295"></a>Comparator Macromodel<hr />
</h1>

<p>
<a id="pgfId-919915"></a>The comparator macromodel is a parameterized macromodel in the analog circuit design environment. This macromodel uses a simplified equivalent circuit to emulate the DC, AC, and transient nature of a real comparator&#8217;s electrical performance. </p>
<p>
<a id="pgfId-919916"></a>A macromodel is advantageous because it reduces computation time and space, but it still retains accuracy. The comparator model shown in this topic is a modified model of the Harris level_0 comparator macromodel, which has a simple RC circuit with the clamping stage. This macromodel represents the performance of both the IC comparator and an ideal comparator as accurately as possible. </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-921658"></a>The use of the comparator macromodel does not create the same device as that denoted earlier in Introduction to Functional Library. For details about the comparator component, see Comparator Symbol.</div>
<p>
<a id="pgfId-919921"></a>The comparator macromodel simulates the following effects:</p>
<ul><li>
<a id="pgfId-919922"></a>Input bias current </li><li>
<a id="pgfId-919923"></a>Input offset current</li><li>
<a id="pgfId-919924"></a>Input offset voltage</li><li>
<a id="pgfId-919925"></a>Input resistance</li><li>
<a id="pgfId-919926"></a>Input capacitance</li><li>
<a id="pgfId-919927"></a>Open loop gain</li><li>
<a id="pgfId-919928"></a>Small-signal delay time</li><li>
<a id="pgfId-919929"></a>Small-signal rising and falling time</li><li>
<a id="pgfId-919930"></a>Overdrive voltage for small-signal transient response test</li><li>
<a id="pgfId-919931"></a>Output voltage swing</li><li>
<a id="pgfId-919932"></a>Output resistance</li></ul>











<h3>
<a id="pgfId-919933"></a>Circuit Design</h3>

<p>
<a id="pgfId-919934"></a>The following figure is a schematic of the comparator macromodel circuit:</p>

<p>
<a id="pgfId-921649"></a></p>
<div class="webflare-div-image">
<img width="668" height="266" src="images/appA-2.gif" /></div>
<h3>
<a id="pgfId-921650"></a>Functional Description</h3>

<p>
<a id="pgfId-921651"></a>There are three stages in the comparator macromodel:</p>
<ul><li>
<a id="pgfId-919947"></a>Input stage</li><li>
<a id="pgfId-919948"></a>Gain and delay stage</li><li>
<a id="pgfId-919949"></a>Output stage</li></ul>



<h4>
<a id="pgfId-919951"></a>Input Stage</h4>

<p>
<a id="pgfId-919952"></a>The input stage is built with four components:</p>
<ul><li>
<a id="pgfId-919953"></a><em>Rin</em> = input resistance</li><li>
<a id="pgfId-919954"></a><em>Cin</em> = input capacitance</li><li>
<a id="pgfId-919955"></a><em>Ibp</em> = bias current </li><li>
<a id="pgfId-919956"></a><em>Ibn</em> = bias current</li></ul>



<p>
<a id="pgfId-919957"></a>The input stage of the comparator macromodel uses a rough linear approximation. The four components model the input current versus voltage variation around the active region. However, the input stage does not model the saturation and cutoff effects of the input currents and terminal resistances.</p>

<h4>
<a id="pgfId-924533"></a>Gain and Delay Stage</h4>

<p>
<a id="pgfId-919959"></a>The gain and delay stage is constructed with a voltage-controlled current source and a single RC time constant circuit.</p>
<p>
<a id="pgfId-919960"></a><em>G1</em>, <em>C1</em>, <em>Cx</em>, and <em>Rd</em> create a single pole roll-off amplifier circuit. <em>Rx</em>, <em>Rd</em>, and <em>G1 </em>model small signal gain.</p>
<p>
<a id="pgfId-919961"></a>The clamping voltages of the two diodes <code>Dh</code> and <code>Dl</code> are set to the value of the positive and negative output voltage swing. These diodes are built to be referenced directly to ground. If the negative output voltage swing <em>VOL </em>is defined as <code>zero</code> like the default value, an independent voltage source of value <em>V</em>OH/2 is inserted between the diodes and ground. This allows the output voltages to have symmetric limiting characteristics. </p>

<h4>
<a id="pgfId-919962"></a>Output Stage</h4>

<p>
<a id="pgfId-919963"></a><em>G2 </em>and <em>RO</em> build the output stage, which forms a gain of one buffer. <em>G2</em> is put there to isolate the gain stage and the outside load to reduce the unwanted influence of the load to the modeling of delay time.</p>

<h3>
<a id="pgfId-919964"></a>Comparator Macromodel Netlist</h3>

<p>
<a id="pgfId-919965"></a>The following shows a netlist of the comparator macromodel:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-921398"></a># comparator 0.s<br /># Description:  Small signal model of input stage, no<br />#               Io limits or power supply effects, simple<br />#               resistive input stage, small large signal<br />#               delay, constant Rout and no current limit<br />#<br /># Format:<br />#<br /># USE  comparator name ibias vos ios rin cin voh vol vis trs tds gol ro<br />#     &amp;1 &amp;2 &amp;3 &amp;4 &amp;5 &amp;6 &amp;7 &amp;8 &amp;9 &amp;10 &amp;11 &amp;12 &amp;13 <br />#<br /># Default values of the parameters:<br />#<br /># &amp;1   model name                                 name = &amp;1<br /># &amp;2   Input bias current                         ibias = 200n<br /># &amp;3   Input offset voltage                       vos = 0<br /># &amp;4   Input offset current                       ios = 10n<br /># &amp;5   Input resistance                           rin = 1meg<br /># &amp;6   Input capacitance                          cin = 1p<br /># &amp;7   Positive output voltage swing              voh = 5<br /># &amp;8   Negative output voltage swing              vol = 0<br /># &amp;9   Overdrive voltage for delay time test      vis = 2m<br /># &amp;10  Small signal rising and falling time test  trs = 20n<br /># &amp;11  Small signal delay time                    tds = 50n<br /># &amp;12  Open loop game                             gol = 100k<br /># &amp;13  Output resistance                          ro = 200<br />#<br />.subckt &amp;1 10 20 30<br />#<br /># Input stage<br />#<br />RIN   10  20   (&amp;5)<br />CIN   10  20   (&amp;6)<br />IBP   10  0    (&amp;2) +(&amp;4)/2<br />IBN   20  0    (&amp;2) -(&amp;4)/2<br />#<br /># Gain Stage<br />#<br />G1  0   2   poly    1  10  20 =-(&amp;3)*(&amp;12)  1E5=(&amp;12)/1E5<br />C1  2   0   ((&amp;11-&amp;10/2)/log(2))/(1E5/&amp;<br />             (&amp;12*(&amp;9)*(&amp;10)/(&amp;7-(&amp;8))/((&amp;11-&amp;10/2)/log(2))-1))<br />RX  2   3   1E5/(&amp;12*(&amp;9)*&amp;10/(&amp;7-(&amp;8))/((&amp;11-&amp;10/2)/log(2))-1)<br />#<br />If &amp;7*(&amp;8)&lt;&gt;0 then <br />  RD   3 0   1E5<br />  DH   3 0   DH<br />  DL   0 3   DL<br /> .MODEL DH D  IS = 0.3*(&amp;12)/1E33  N = &amp;7/VT/LOG(1E28) <br /> .MODEL DL D  IS = 0.3*(&amp;12)/1E33  N = -(&amp;8)/VT/LOG(1E28)<br />else<br />  RD   3 8    1E5<br />  DH   3 8    DM<br />  DL   8 3    DM<br />  VM   8 0    (&amp;7+(&amp;8))/2<br /> .MODEL DM D  IS=0.3*(&amp;12)/1E33  N=(&amp;7+&amp;(&amp;8))/2/VT/LOG(1E28) <br />endif<br />#<br />#   Output Stage<br />#<br />RO  0 30   (&amp;13)<br />G2  0 30   poly 1 3 0  0 =1/(&amp;13+0.1)<br />.ends &amp;1</pre>
<h3>
<a id="pgfId-923861"></a>Example</h3>

<p>
<a id="pgfId-923863"></a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap1.html" id="prev" title="Introduction to Functional Block Library">Introduction to Functional Blo ...</a></em></b><b><em><a href="appA_re_Uses_of_the_Comparator_Macromodel.html" id="nex" title="Uses of the Comparator Macromodel">Uses of the Comparator Macromo ...</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;⠀ </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>