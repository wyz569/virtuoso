
<html><head><title>Ratiometric Fourier Analyzer (fourier)</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="namratam" />
<meta name="CreateDate" content="2023-06-12" />
<meta name="CreateTime" content="1686594941" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the model equations for Cadence circuit simulators" />
<meta name="DocTitle" content="Spectre Circuit Simulator Components and Device Models Reference" />
<meta name="DocType" content="Reference" />
<meta name="FileTitle" content="Ratiometric Fourier Analyzer (fourier)" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="spectremod" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-06-12" />
<meta name="ModifiedTime" content="1686594941" />
<meta name="NextFile" content="Chap1_re_IBIS_I_O_buffer_ibis_buffer_.html" />
<meta name="Group" content="Spectre Simulator" />
<meta name="Platform" content="Analog RF  Mixed-Signal Design" />
<meta name="PrevFile" content="Chap1_re_Ideal_Switch_switch_.html" />
<meta name="c_product" content="Spectre" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre Circuit Simulator Components and Device Models Reference -- Ratiometric Fourier Analyzer (fourier)" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="reference" />
<meta name="reference_type" content="command reference" />
<meta name="prod_feature" content="Models" />
<meta name="prod_subfeature" content="Circuit Components" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="23.1" />
<meta name="SpaceKey" content="spectremod231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectremodTOC.html">Contents</a></li><li><a class="prev" href="Chap1_re_Ideal_Switch_switch_.html" title="Ideal Switch (switch)">Ideal Switch (switch)</a></li><li style="float: right;"><a class="viewPrint" href="spectremod.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="Chap1_re_IBIS_I_O_buffer_ibis_buffer_.html" title="IBIS I/O buffer (ibis_buffer)">IBIS I/O buffer (ibis_buffer)</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre Circuit Simulator Components and Device Models Reference<br />Product Version 23.1, June 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<a id="Filename:re_Ratiometric_Fourier_Analyzer_fourier_" title="Ratiometric Fourier Analyzer (fourier)"></a><h2>
<a id="pgfId-1039477"></a><a id="82828"></a>Ratiometric Fourier Analyzer (fourier)</h2>

<p>
<a id="pgfId-1039478"></a>The ratiometric Fourier analyzer measures the Fourier coefficients of two different signals at a specified fundamental frequency without loading the circuit. The algorithm used is based on the Fourier integral rather than the discrete Fourier transform and therefore is not subject to aliasing. Even on broad-band signals, it computes a small number of Fourier coefficients accurately and efficiently. Therefore, this Fourier analyzer is suitable on clocked sinusoids generated by sigma-delta converters, pulse-width modulators, digital-to-analog converters, sample-and-holds, and switched-capacitor filters as well as on the traditional low-distortion sinusoids produced by amplifiers or filters.</p>
<p>
<a id="pgfId-1039479"></a>The analyzer is active only during transient analysis. For each signal, the analyzer prints the magnitude and phase of the harmonics along with the total harmonic distortion at the end of the transient analysis. The total harmonic distortion is found by adding the power in all of the computed harmonics except DC and fundamental. Consequently, the distortion is not accurate if you request an insufficient number of harmonics The Fourier analyzer also prints the ratio of the spectrum of the first signal to the fundamental of the second, therefore, you can use the analyzer to compute large signal gains and immittances directly.</p>
<p>
<a id="pgfId-1039480"></a>If you are concerned about accuracy, perform an additional Fourier transform on a pure sinusoid generated by an independent source. Because both transforms use the same time points, the relative errors measured with the known pure sinusoid are representative of the errors in the other transforms. In practice, this second Fourier transform is performed on the reference signal. To increase the accuracy of the Fourier transform, use the <code>points</code> parameter to increase the number of points. Tightening <code>reltol</code> and setting <code>errpreset=conservative</code> are two other measures to consider. </p>
<p>
<a id="pgfId-1039481"></a>The accuracy of the magnitude and phase for each harmonic is independent of the number of harmonics computed. Therefore, increasing the number of harmonics (while keeping <code>points</code> constant) does not change the magnitude and phase of the low-order harmonics, but it does improve the accuracy of the total harmonic distortion computation. However, if you do not specify <code>points</code>, you can increase accuracy by requesting more harmonics, which creates more points.</p>
<p>
<a id="pgfId-1039482"></a>The large number of points required for accurate results is not a result of aliasing. Many points are needed because a quadratic polynomial interpolates the waveform between the time-points. If you use too few time-points the polynomials deviate slightly from the true waveform between the time-points and all of the computed Fourier coefficients are slightly in error. The algorithm that computes the Fourier integral does accept unevenly spaced time-points, but because it uses quadratic interpolation, it is usually more accurate using time-steps that are small and nearly evenly spaced. </p>
<p>
<a id="pgfId-1039483"></a>This device is not supported within altergroup.</p>

<h3>
<a id="pgfId-1039484"></a>Sample Instance Statement</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1039485"></a>four1 (1 0) fourmod harms=50</pre>
<h3>
<a id="pgfId-1039486"></a>Sample Model Statement</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1039487"></a>model fourmod fourier fund=900M points=2500 order=2</pre>
<h3>
<a id="pgfId-1039489"></a>Instance Syntax<a id="marker-1039488"></a></h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1039490"></a>Name&#160;&#160;[p]&#160;&#160;[n]&#160;&#160;[pr]&#160;&#160;[nr] ModelName parameter=value ...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1039491"></a>Name&#160;&#160;[p]&#160;&#160;[n]&#160;&#160;[pr]&#160;&#160;[nr] fourier parameter=value ...</pre>

<p>
<a id="pgfId-1039492"></a>The signal between terminals <code>p</code> and <code>n</code> is the test or numerator signal. The signal between terminals <code>pr</code> and <code>nr</code> is the reference or denominator signal. Fourier analysis is performed on terminal currents by specifying the <code>term</code> or <code>refterm</code> parameters. If both <code>term</code> and <code>p</code> or <code>n</code> are specified, the terminal current becomes the numerator and the node voltages become the denominator. By mixing voltages and currents, it is possible to compute large signal immittances.</p>

<h3>
<a id="pgfId-1039494"></a>Instance Parameters</h3>
<p>
<a id="pgfId-1060356"></a><a id="marker-1039493"></a></p>
<table class="webflareTable" id="#id1060253">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093123"></a><code>fund (Hz)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093125"></a>Fundamental frequency.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093127"></a><code>points=20 maxharm</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093129"></a>Minimum number of time points.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093131"></a><code>active=yes</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093133"></a>Whether Fourier analysis should be performed or skipped. Possible values are <code>no</code> or <code>yes</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093135"></a><code>order=2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093137"></a>Order of interpolation.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093139"></a><code>term</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093141"></a>Terminal used to measure current for the test (numerator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093143"></a><code>refterm</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093145"></a>Terminal used to measure current for the reference (denominator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093147"></a><code>harmsvec=[...]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093149"></a>Array of desired harmonics for the test (numerator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093151"></a><code>harms=9</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093153"></a>Number of harmonics for test (numerator) channel, if an array is not given. The harmonics start from <code>firstharm</code> and go up to <code>firstharm</code> + <code>harms</code> - 1.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093155"></a><code>refharmsvec=[...]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093157"></a>Array of desired harmonics for the reference (denominator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093159"></a><code>refharms=9</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093161"></a>Number of harmonics for the reference (denominator) channel, if an array is not given. The harmonics start from <code>reffirstharm</code> and go up to <code>reffirstharm</code> + <code>harms</code> - 1.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093163"></a><code>scale=1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093165"></a>Scale factor for the ratio results.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093167"></a><code>firstharm=1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093169"></a>First harmonic computed for the test (numerator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093171"></a><code>reffirstharm=1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093173"></a>First harmonic computed for the reference (denominator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093175"></a><code>normharm=1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093177"></a>Normalizing harmonic for test the (numerator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093179"></a><code>refnormharm=1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093181"></a>Normalizing harmonic for the reference (denominator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093183"></a><code>where=logfile</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093185"></a>Location where the fourier results should be printed. Possible values are <code>screen</code>, <code>logfile</code>, and <code>both</code>.</p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1039512"></a>Model Syntax<a id="marker-1039511"></a></h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1039513"></a>model modelName fourier parameter=value ...</pre>
<h3>
<a id="pgfId-1039515"></a>Model Parameters<a id="marker-1039514"></a></h3>
<table class="webflareTable" id="#id1060377">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093193"></a><code>fund (Hz)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093195"></a>Fundamental frequency.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093197"></a><code>points=20 maxharm</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093199"></a>Minimum number of time points.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093201"></a><code>harms=9</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093203"></a>Desired number of harmonics.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093205"></a><code>active=yes</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093207"></a>Specify whether fourier analysis should be performed or skipped. Possible values are <code>no</code> or <code>yes</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093209"></a><code>order=2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093211"></a>Order of interpolation.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093213"></a><code>firstharm=1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093215"></a>First harmonic computed for the test (numerator) channel.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093217"></a><code>reffirstharm=1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1093219"></a>First harmonic computed for the reference (denominator) channel.</p>
</td>
</tr>
</tbody></table>
<h4><em>
<a id="pgfId-1093228"></a>Related Topics</em></h4>

<p>
<a id="pgfId-1093232"></a><a href="Chap1_re_Ideal_Switch_switch_.html#20434">Ideal Switch (switch)</a></p>
<p>
<a id="pgfId-1093236"></a><a href="Chap1_re_IBIS_I_O_buffer_ibis_buffer_.html#90596">IBIS I/O buffer (ibis_buffer)</a></p>
<p>
<a id="pgfId-1093224"></a><a href="Chap1.html#44786">Circuit Components</a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="Chap1_re_Ideal_Switch_switch_.html" id="prev" title="Ideal Switch (switch)">Ideal Switch (switch)</a></em></b><b><em><a href="Chap1_re_IBIS_I_O_buffer_ibis_buffer_.html" id="nex" title="IBIS I/O buffer (ibis_buffer)">IBIS I/O buffer (ibis_buffer)</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;â € </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>