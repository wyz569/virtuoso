
<html><head><title>Subcircuit Definitions (subckt)</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="rrohit" />
<meta name="CreateDate" content="2023-08-31" />
<meta name="CreateTime" content="1693484715" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Provides reference information on the Spectre circuit simulator." />
<meta name="DocTitle" content="Spectre Circuit Simulator Reference" />
<meta name="DocType" content="Reference" />
<meta name="FileTitle" content="Subcircuit Definitions (subckt)" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="spectreref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-08-31" />
<meta name="ModifiedTime" content="1693484715" />
<meta name="NextFile" content="chap4_re_Vec_Vcd_Evcd_Digital_Stimulus_vector.html" />
<meta name="Order" content="2" />
<meta name="Group" content="Spectre Simulator" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="chap4_re_Stitch_Flow_Use_Model_stitch.html" />
<meta name="c_product" content="Spectre" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre Circuit Simulator Reference -- Subcircuit Definitions (subckt)" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="23.1" />
<meta name="SpaceKey" content="spectreref231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectrerefTOC.html">Contents</a></li><li><a class="prev" href="chap4_re_Stitch_Flow_Use_Model_stitch.html" title="Stitch Flow Use Model (stitch)">Stitch Flow Use Model (stitch)</a></li><li style="float: right;"><a class="viewPrint" href="spectreref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap4_re_Vec_Vcd_Evcd_Digital_Stimulus_vector.html" title="Vec/Vcd/Evcd Digital Stimulus (vector)">Vec/Vcd/Evcd Digital Stimulus  ...</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre Circuit Simulator Reference<br />Product Version 23.1, September 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<a id="Filename:re_Subcircuit_Definitions_subckt" title="Subcircuit Definitions (subckt)"></a><h2>
<a id="pgfId-1049093"></a><a id="23450"></a>Subcircuit<a id="subckt"></a> Definitions (subckt)<a id="marker-1049092"></a></h2>
<h4>
<a id="pgfId-1049095"></a>Description<a id="marker-1049094"></a></h4>
<h4><em>
<a id="pgfId-1049096"></a>Hierarchical Circuit </em></h4>

<p>
<a id="pgfId-1049097"></a>The <code>subckt</code> statement is used to define a subcircuit. Subcircuit definitions are circuit macros that can be expanded anywhere in the circuit any number of times. When an instance in your input file refers to a subcircuit definition, the instances specified within the subcircuit are inserted into the circuit. Subcircuits may be nested. Therefore, a subcircuit definition may contain instances of other subcircuits. Subcircuits may also contain component, analysis, or model statements. Subcircuit definitions can also be nested, in which case the innermost subcircuit definition can only be referenced from within the subcircuit in which it is defined, and cannot be referenced from elsewhere. </p>
<p>
<a id="pgfId-1049098"></a>Instances that instantiate a subcircuit definition are referred to as subcircuit calls. The node names (or numbers) specified in the subcircuit call are substituted, in order, for the node names given in the subcircuit definition. All instances that refer to a subcircuit definition must have the same number of nodes as are specified in the subcircuit definition and in the same order. Node names inside the subcircuit definition are strictly local unless declared otherwise in the input file with a global statement.</p>

<h4><em>
<a id="pgfId-1049099"></a>Subcircuit Parameters</em></h4>

<p>
<a id="pgfId-1049100"></a>Parameter specification in subcircuit definitions is optional. In the case of nested subcircuit definitions, parameters that have been declared for the outer subcircuit definition are also available within the inner subcircuit definition. Parameters that are specified are referred to by name, optionally followed by an <code>=</code> sign and a default value. If, when making a subcircuit call, you do not specify a particular parameter, this default value is used in the macro expansion. Subcircuit parameters can be used in expressions within the subcircuit consisting of subcircuit parameters, constants, and various mathematical operators. Run <code>spectre -h expressions</code> for details about Spectre expression handling capability. Run <code>spectre -h parameters</code> for details about how Spectre handles netlist parameters, including subcircuit parameters, and how they inherit within nested subcircuit definitions.</p>
<p>
<a id="pgfId-1049102"></a>Subcircuits always have an implicitly defined parameter <code>m</code>. This parameter is passed to all components in the subcircuit, and each component is expected to multiply it by its own multiplicity factor. In this way, it is possible to efficiently model several copies of the subcircuit in parallel. Any attempt to explicitly define <code>m</code> on a <code>parameters</code> line results in an error. In addition, because <code>m</code> is only implicitly defined, it is not available for use in expressions in the subcircuit.</p>

<h4><em>
<a id="pgfId-1049104"></a>Inline Subcircuits</em></h4>

<p>
<a id="pgfId-1049105"></a>An inline subckt is a special case of a subckt where one of the devices or models instantiated within this subckt does not get its full hierarchical name. It instead inherits the subckt call name. An inline subckt is syntactically denoted by the presence of the keyword <code>inline</code> before the <code>subckt</code>. It is called in the same manner as a regular subcircuit. The body of the inline subcircuit can typically contain one of the following, based on different use models:</p>
<ul><li>
<a id="pgfId-1049106"></a>Multiple device instances, one of which is the <code>inline</code> component </li><li>
<a id="pgfId-1049107"></a>Multiple device instances, one of which is <code>inline</code> and one or more parameterized models </li><li>
<a id="pgfId-1049109"></a>A single <code>inline</code> device instance and a parameterized model to which the device instance refers </li></ul>


<p>
<a id="pgfId-1049111"></a>The <code>inline</code> component is denoted by giving it the same name as the inline subcircuit. When the subcircuit is flattened, the <code>inline</code> component does not take on a hierarchical name such as <code>X1.M1</code>, it instead takes on the name of the subckt call, such as <code>X1</code>. Any non-inline components in the subckt take on the regular hierarchical name, as if the subcircuit were a regular subckt (that is, not an <code>inline</code> subckt).</p>

<h4><em>
<a id="pgfId-1049112"></a>Probing the inline device</em></h4>

<p>
<a id="pgfId-1049113"></a>Spectre allows the following list of items to be saved or probed for primitive devices. These would also apply to devices modeled as the inline components of inline subcircuits:</p>
<ul><li>
<a id="pgfId-1049114"></a>All terminal currents. For example, <code>save q1:currents</code></li><li>
<a id="pgfId-1049115"></a>Specific (index) terminal current. For example, <code>save q1:1 (#1=collector)</code></li><li>
<a id="pgfId-1049116"></a>Specific (named) terminal current. For example, <code>save q1:b (&quot;b&quot;=base)</code></li><li>
<a id="pgfId-1049117"></a>Save all operating point info. For example, <code>save q1:oppoint</code></li><li>
<a id="pgfId-1049118"></a>Save specific operating point info. For example, <code>save q1:vbe</code></li><li>
<a id="pgfId-1049119"></a>Save all currents and oppoint info. For example, <code>save q1</code></li></ul>






<h4><em>
<a id="pgfId-1049120"></a>Parameterized Models and Inline Subckts</em></h4>

<p>
<a id="pgfId-1049121"></a>Inline subckts can be used in the same way as regular subcircuits to implement parameterized models, however, inline subckts provide some powerful new options. When an inline subcircuit contains both a parameterized model and an inline device that references that model, you can create instances of the device, and each device automatically gets an appropriately scaled model assigned to it. For example, the instance parameters to an inline subckt could represent something like emitter width and length of a BJT device, and within the subckt, a model card that is parameterized for emitter width and length and scales can be created accordingly. When you instantiate the macro, supply the values for the emitter width and length, and a device is instantiated with an appropriate geometrically scaled model. Again, the inline device does not get a hierarchical name and can be probed in the same manner as the inline device in the previous section on modeling parasitics, that is, the inline device can be probed just as if it were a simple device, and not actually embedded in a subckt</p>

<h4><em>
<a id="pgfId-1049122"></a>Automatic Model Selection using Inline Subckts</em></h4>

<p>
<a id="pgfId-1049123"></a>See <code>spectre -h if</code> for a description on how to combine Spectres <code>structural if</code> statement with inline subckts to perform automatic model selection based on <code>any</code> netlist/subckt parameter.</p>
<p>
<a id="pgfId-1086378"></a>For additional information on subcircuits, see <em><a actuate="user" class="URL" href="../spectreuser/chap5.html#definesub" show="replace" xml:link="simple">Subcircuits</a></em> in the <em>Spectre Classic Simulator, Spectre APS, Spectre X, and Spectre XPS User Guide</em>.</p>

<h4>
<a id="pgfId-1068553"></a>Definition<a id="marker-1068552"></a></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1068554"></a>[inline] subckt &lt;Name&gt; (&lt;node1&gt; ... &lt;nodeN&gt;)</pre>

<p>
<a id="pgfId-1068556"></a><strong>Example 1: </strong>subckt </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049128"></a>subckt coax (i1 o1 i2 o2)</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1049129"></a>parameters zin=50 zout=50 vin=1 vout=1 len=0</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1049130"></a>inner i1 o1 i2 o2&#160;&#160;tline z0=zin vel=vin len=len</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1049131"></a>outer o1 0&#160;&#160;o2 0&#160;&#160; tline z0=zout vel=vout len=len</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049132"></a>ends coax</pre>

<p>
<a id="pgfId-1049133"></a>Defines a parameterized coaxial transmission line macro from two ideal transmission lines. To instantiate this subcircuit, one could use an instance statement such as:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049134"></a>Coax1 pin nin out gnd coax zin=75 zout=150 len=35m</pre>

<p>
<a id="pgfId-1049135"></a><strong>Example 2: inline subckt - parasitics</strong> </p>
<p>
<a id="pgfId-1049136"></a>Consider the following example of an inline subcircuit, which contains a mosfet instance, and two parasitic capacitances: </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049137"></a>inline subckt s1 (a b)&#160;&#160;              // &quot;s1&quot; is name of subckt </pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1049138"></a>parameters p1=1u p2=2u</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1049139"></a>s1 (a b 0 0) mos_mod l=p1 w=p2&#160;&#160;     // &quot;s1&quot; is &quot;inline&quot; component</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1049140"></a>cap1 (a 0) capacitor c=1n</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1049141"></a>cap2 (b 0) capacitor c=1n</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049142"></a>ends s1</pre>

<p>
<a id="pgfId-1049143"></a>The following circuit creates a simple mos device instance <code>M1</code>, and calls the inline subcircuit <code>s1</code> twice (<code>M2</code> and <code>M3</code>) </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049144"></a>M1 (2 1 0 0) mos_mod</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049145"></a>M2 (5 6) s1 p1=6u p2=7u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049146"></a>M3 (6 7) s1</pre>

<p>
<a id="pgfId-1049147"></a>This expands/flattens to:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049148"></a>M1 (2 1 0 0) mos_mod</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049149"></a>M2 (5 6 0 0) mos_mod l=6u w=7u&#160;&#160;// the &quot;inline&quot; component, inherits call name</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049150"></a>M2.cap1 (5 0) capacitor c=1n&#160;&#160;  // a regular hierarchical name</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049151"></a>M2.cap2 (6 0) capacitor c=1n</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049152"></a>M3 (6 7 0 0) mos_mod l=1u w=2u&#160;&#160;// the &quot;inline&quot; component, inherits call name</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049153"></a>M3.cap1 (6 0) capacitor c=1n</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049154"></a>M3.cap2 (7 0) capacitor c=1n</pre>

<p>
<a id="pgfId-1049155"></a>Here, the final flattened names of the three mosfets (one for each instance) are <code>M1</code>, <code>M2</code>, and <code>M3</code>, rather than <code>M1</code>, <code>M2.s1</code>, and <code>M3.s1</code> as they would be if <code>s1</code> was a regular subcircuit. However, the parasitic capacitors (which you may not interested in, or perhaps, even aware of, if the inline subckt definition was written by a different modeling engineer) have full hierarchical names.</p>
<p>
<a id="pgfId-1049156"></a><strong>Example 3: inline subckt - scaled models</strong></p>
<p>
<a id="pgfId-1060914"></a>Consider the following example, in which a parameterized model is declared within an inline subcircuit for a bipolar transistor. The model parameters are emitter width, length, and area, and also the temperature delta (<code>trise</code>) of the device above nominal. Ninety-nine instances of a 4*4 transistor are then placed and one instance of a transistor with area=50 is placed. Each transistor gets an appropriately scaled model.</p>
<p>
<a id="pgfId-1060915"></a>Declare a subckt, which instantiates a transistor with a parameterized model. The parameters are emitter width and length.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049161"></a>inline subckt bjtmod (c b e s)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049162"></a>parameters le=1u we=2u area=le*we trise=0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049163"></a>model mod1 bjt type=npn bf=100+(le+we)/2*(area/1e-12) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049164"></a>+&#160;&#160;     is=1e-12*(le/we)*(area/1e-12) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049165"></a>bjtmod (c b e s) mod1 trise=trise&#160;&#160;     // &quot;inline&quot; component</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049166"></a>ends bjtmod</pre>

<p>
<a id="pgfId-1049167"></a>some instances of this subckt</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049168"></a>q1 (2 3 1 0) bjtmod le=4u we=4u&#160;&#160;       // trise defaults to zero</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049169"></a>q2 (2 3 2 0) bjtmod le=4u we=4u trise=2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049170"></a>q3 (2 3 3 0) bjtmod le=4u we=4u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049171"></a>.....</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049172"></a>.....</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049173"></a>q99 (2 3 99 0) bjtmod le=4u we=4u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049174"></a>q100 (2 3 100 0) bjtmod le=1u area=50e-12 </pre>
<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap4_re_Stitch_Flow_Use_Model_stitch.html" id="prev" title="Stitch Flow Use Model (stitch)">Stitch Flow Use Model (stitch)</a></em></b><b><em><a href="chap4_re_Vec_Vcd_Evcd_Digital_Stimulus_vector.html" id="nex" title="Vec/Vcd/Evcd Digital Stimulus (vector)">Vec/Vcd/Evcd Digital Stimulus  ...</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;â € </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>