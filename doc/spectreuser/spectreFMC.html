
<html><head><title>Spectre FMC Analysis</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="namratam" />
<meta name="CreateDate" content="2023-09-01" />
<meta name="CreateTime" content="1693555270" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the features of Spectre Classic Simulator, Spectre APS, Spectre X, Spectre XPS, Spectre FMC analysis, and Legato reliability solution." />
<meta name="DocTitle" content="Spectre Classic Simulator, Spectre APS, Spectre X, Spectre XPS, Spectre FMC Analysis, and Legato Reliability Solution User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Spectre FMC Analysis" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="spectreuser" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-09-01" />
<meta name="ModifiedTime" content="1693555270" />
<meta name="NextFile" content="chap3.html" />
<meta name="Order" content="1" />
<meta name="Group" content="Spectre Simulator" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="spectrex.html" />
<meta name="c_product" content="Spectre" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre Classic Simulator, Spectre APS, Spectre X, Spectre XPS, Spectre FMC Analysis, and Legato Reliability Solution User Guide -- Spectre FMC Analysis" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="23.1" />
<meta name="SpaceKey" content="spectreuser231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectreuserTOC.html">Contents</a></li><li><a class="prev" href="spectrex.html" title="The Spectre X Circuit Simulator">The Spectre X Circuit Simulato ...</a></li><li style="float: right;"><a class="viewPrint" href="spectreuser.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap3.html" title="SPICE Compatibility">SPICE Compatibility</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre Classic Simulator, Spectre APS, Spectre X, Spectre XPS, Spectre FMC Analysis, and Legato Reliability Solution User Guide<br />Product Version 23.1, September 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>6
<a id="pgfId-1065082"></a> </h1>
<h1>
<a id="pgfId-1065083"></a><hr />
<a id="36930"></a>Spectre FMC Analysis<hr />
</h1>

<p>
<a id="pgfId-1097547"></a>As the process feature sizes have scaled down, the impact of device mismatch on circuit performance has increased and more Monte Carlo simulations are required to analyze the impact of this mismatch on performance metrics. With standard Monte Carlo algorithms, it is not feasible (high cost) to complete even the one million Monte Carlo simulations needed in memory design to determine 4 sigma yield numbers. For high-sigma yield analysis, more than one billion simulations would be required.</p>
<p>
<a id="pgfId-1087292"></a>Spectre FMC Analysis has an advanced algorithm to accelerate the high-sigma yield estimation. It lets you extract the useful statistical information without running the full set of Monte Carlo samples, especially for high-sigma analysis.</p>
<p>
<a id="pgfId-1097567"></a>For more details, refer to the following topics:</p>
<p>
<a id="pgfId-1097571"></a><a href="spectreFMC.html#88535">Technology and Overview</a></p>
<p>
<a id="pgfId-1097575"></a><a href="spectreFMC.html#36065">Use Model and Applications</a></p>
<p>
<a id="pgfId-1097579"></a><a href="spectreFMC.html#70525">Setup to Enhance the Performance of a Fast Monte Carlo Simulation</a></p>
<p>
<a id="pgfId-1097583"></a><a href="spectreFMC.html#44999">Post-Process Fast Monte Carlo Data</a></p>

<h3>
<a id="pgfId-1097585"></a><a id="88535"></a>Technology and Overview</h3>

<p>
<a id="pgfId-1097586"></a>Fast Monte Carlo runs a group of samples initially and obtains the measurements. Then, the library with newer algorithm builds a model and predicts the worst sample based on the result and specifications set by user. It may take a few group iterations from model building, worst sampling prediction and verification to find out the tail of distribution. This Fast Monte Carlo technology improves performance greatly and reduces memory cost when compared to the normal Monte Carlo simulation.</p>
<p>
<a id="pgfId-1097587"></a>In addition to the new approach adopted in Monte Carlo Analysis and the auto-stop enabled to shorten the simulation time, Fast Monte Carlo also supports multi-processes distribution to further speed up the performance. Sample generation, model evaluation and simulation are now processed by parallel workers. </p>
<p>
<a id="pgfId-1097588"></a>A typical distribution flow for Fast Monte Carlo is shown below.</p>

<p>
<a id="pgfId-1097592"></a></p>
<div class="webflare-div-image">
<img width="668" height="510" src="images/spectreFMC-2.gif" /></div>
<h3>
<a id="pgfId-1097594"></a><a id="36065"></a>Use Model and Applications</h3>

<p>
<a id="pgfId-1097595"></a>In addition to the brute-force setup, the use model for Fast Monte Carlo analysis involves the following tasks:</p>
<p>
<a id="pgfId-1097599"></a><a href="spectreFMC.html#92779">Setting up a Fast Monte Carlo Goal</a></p>
<p>
<a id="pgfId-1097603"></a><a href="spectreFMC.html#22526">Specifying the Fast Monte Carlo Method</a></p>
<p>
<a id="pgfId-1097607"></a><a href="spectreFMC.html#96767">Enabling Sweep Sigma Trend with Fast Monte Carlo in a Single Run</a></p>
<p>
<a id="pgfId-1097611"></a><a href="spectreFMC.html#74534">Specifying Other Parameters for Fast Monte Carlo</a></p>
<p>
<a id="pgfId-1097615"></a><a href="spectreFMC.html#13528">Enable Moments in Fast Monte Carlo</a></p>
<p>
<a id="pgfId-1097619"></a><a href="spectreFMC.html#95165">Yield Estimation with Brute Force Monte Carlo</a></p>

<h4>
<a id="pgfId-1097621"></a><strong>Setting up a Fast Monte Carlo Goal</strong><a id="92779"></a></h4>

<p>
<a id="pgfId-1097622"></a>From the netlist, identify a list of measurements that are used to verify the correct functional behavior of the design under test and specify those measurements as goals to drive the high-sigma analysis. </p>
<p>
<a id="pgfId-1097623"></a>You can specify goals by using the <code>target</code> block in the <code>statistics</code> statement. Syntax of the target block is shown below.</p>
<p>
<a id="pgfId-1097624"></a>The syntax for this block is as follows;</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097625"></a>statistics {<br />target {<br />goal &lt;measurement_name&gt; min=&lt;value&gt;<br />goal &lt;measurement_name&gt; max=&lt;value&gt;<br />goal &lt;measurement_name&gt; min=&lt;value&gt; max =&lt;value&gt;<br />}<br />}</pre>

<p>
<a id="pgfId-1097626"></a>You can specify either a single measurement name with a min goal, max goal or both min and max goals, or multiple measurement names with a min goal, max goal or both min and max goals.</p>
<p>
<a id="pgfId-1097627"></a>The keyword of <code>max</code> intends to look for the worst tails on the positive sigma side of the statistics distribution while <code>min</code> is to find the negative sigma side. The values for min and max set the criteria for Spectre to count the number of #pass or #failed for each iteration. They can also be used for setting autostop conditions through parameter <code>fmcnumfails</code>.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1097628"></a>Only the measurements specified using <code>.MEASURE</code> syntax can be used as goals in Spectre command-line flow. The goal cannot be from a measurement that is defined using the MDL format or evaluated in a post-processing mode using OCEAN.</div>
<p>
<a id="pgfId-1097629"></a>An example of a targets block is shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097630"></a>.MEASURE tpdr<br />+ TRIG v(b) VAL=&#39;PWR_SUPPLY/2&#39; FALL=1<br />TARG v(c) VAL=&#39;PWR_SUPPLY/2&#39; RISE=1<br />.MEASURE tpdf<br />+ TRIG v(b) VAL=&#39;PWR_SUPPLY/2&#39; RISE=1<br />TARG v(c) VAL=&#39;PWR_SUPPLY/2&#39; FALL=1<br />.MEASURE tpd param=&#39;(tpdr+tpdf)/2&#39;<br />Simulator lang=spectre<br />// Use the targets block in the statistics statement to<br />// define which measurements are to be analyzed with FMC<br />
statistics {
<strong>targets {<br />goal tpd min=8p max=10p<br />}<br /></strong>}</pre>

<p>
<a id="pgfId-1097631"></a>Best practices to avoid unnecessary issues that may seem like a product defect:</p>
<ul><li>
<a id="pgfId-1097632"></a>If there are two or more measurements from the design that the you would like to use as a part of the high-sigma analysis, then it is better not to combine them in a single Spectre FMC run. For better accuracy and performance, it is better to do separate individual high-sigma runs for each measurement goal of interest.</li><li>
<a id="pgfId-1097633"></a>If there are two measurements where one is a timing measurement and one is voltage measurement, then it is advised not to mix these goals in a single Spectre FMC run. </li><li>
<a id="pgfId-1097634"></a>If you know that a min for the goal or a max for the goal would not make sense for a high sigma analysis, then it is advised to use either a min goal or a max goal for the specific measurement based on what is the actual criteria for a failure.</li></ul>



<h4>
<a id="pgfId-1097636"></a><strong>Specifying the Fast Monte Carlo Method</strong><a id="22526"></a></h4>

<p>
<a id="pgfId-1097637"></a>Use the <code>fmcmethod</code> parameter to specify the method or algorithm to be used and the outputs required for your design. FMC can use three methods, <code>worstsample</code>, <code>yield</code>, and <code>yieldest</code> to obtain the statistical result. Amongst the first two, it is recommended to use <code>worstsample</code> because it allows exploration of high-sigma tails with more useful information while yield is more of a pass/fail analysis.</p>

<h4><em>
<a id="pgfId-1097638"></a>The Worstsample Method</em></h4>

<p>
<a id="pgfId-1097639"></a>For <code>worstsample</code>, specify any two of the following three parameters in the Monte Carlo statement.</p>

<p>
<a id="pgfId-1097661"></a></p>
<table class="webflareTable" id="#id1097640">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097642">
<a id="pgfId-1097642"></a>Parameter</span>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097644">
<a id="pgfId-1097644"></a>Description</span>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097646"></a><code>numruns</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097648"></a>Controls the MC sample space of interest, or the total number of MC samples to be considered while trying to find the worst-case samples.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097650"></a><code>fmcinitruns=50</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097652"></a>Specifies the number of runs in FMC initial group to build the model.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097654"></a><code>fmcsigma</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097656"></a>Specifies a target yield in an easier form like a sigma value. Instead of specifying at target yield of 99.996832875816693 %, the user can specify it as a sigma value, fmcsigma=4. The maximum sigma value supported is 6 sigma.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097658"></a><code>fmcnumtailsamples</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097660"></a>Controls the number of high sigma tail samples to be estimated.</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1097662"></a>The following are examples of multiple combinations of any two parameters:</p>
<ul><li>
<a id="pgfId-1097663"></a>Driving Spectre FMC by specifying the number of samples in the monte carlo sample space (<code>numruns</code>) and the target yield in the form of a sigma value (<code>fmcsigma</code>). <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1097664">
<a id="pgfId-1097664"></a>mc1 montecarlo fmcmethod=worstsample <strong>numruns=1e6 fmcsigma=4.2</strong> {
    tran tran stop=3n
}
</pre></li><li>
<a id="pgfId-1097665"></a>Driving Spectre FMC by specifying the number of samples in the monte carlo sample space (<code>numruns</code>) and specifying the number of worst-case tail samples (<code>fmcnumtailsamples</code>).<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1097666">
<a id="pgfId-1097666"></a>mc1 montecarlo fmcmethod=worstsample <strong>numruns=1e6</strong> 
    <strong>fmcnumtailsamples=14</strong> {
    tran tran stop=3n
}</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1097667">
<a id="pgfId-1097667"></a></pre></li><li>
<a id="pgfId-1097668"></a>Driving Spectre FMC by only specifying the target yield in the form of a sigma value (<code>fmcsigma</code>) and the number of worst-case tail samples (<code>fmcnumtailsamples</code>) to be estimated. There is no need to specify total sampling number.<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1097669">
<a id="pgfId-1097669"></a>mc1 montecarlo fmcmethod=worstsample <strong>fmcsigma=4.2</strong> 
    <strong>fmcnumtailsamples=14</strong> {
    tran tran step=1p stop=tran_time autostop=yes method=gear2
}</pre></li></ul>






<p>
<a id="pgfId-1097670"></a>The following settings are equivalent because for one million samples, the sample at 4.2 sigma is the 14th worst sample while FMC will report 14 samples and the sigma range is (4.2, 4.89) when <code>numruns=1M</code> <code>fmcsigma=4.2</code>.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097671"></a> &quot;numruns=1M fmcsigma=4.2, or </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097672"></a> &quot;fmcsigma=4.2 fmcnumtailsamples=14, or</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097673"></a> &quot;numruns=1M fmcnumtailsamples=14</pre>

<p>
<a id="pgfId-1097674"></a>Below are examples of multiple combinations of any two parameters.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097675"></a>mc1 montecarlo numruns=20000 firstrun=1 seed=12345 variations=all \<br />donominal=no savefamilyplots=no \<br />fmcmethod=worstsample fmcsigma=3 {<br />tran tran step=1p stop=2n<br />}</pre>
<h4><em>
<a id="pgfId-1097676"></a>The Yieldest Method</em></h4>

<p>
<a id="pgfId-1097677"></a>Spectre FMC estimates the failure rate based on the boundaries of measurement goal with much fewer sample set by fmcbudget. This feature provides the approximation result so that you can use it as a reference to set up the FMC worst sample simulation if you don&#39;t know what yield is expected for the design. </p>
<p>
<a id="pgfId-1097678"></a><code>mc1 montecarlo numruns=1e+6 </code><strong>fmcmethod=yieldest</strong><code> fmcbudget=3000 &#8220;<br />    </code><strong>fmcconfidence=0.95</strong><code> {<br />    tran tran step=1p stop=tran_time autostop=yes method=gear2<br />    }</code></p>
<p>
<a id="pgfId-1097679"></a></p>

<h4>
<a id="pgfId-1097681"></a><a id="96767"></a>Enabling Sweep Sigma Trend with Fast Monte Carlo in a Single Run</h4>

<p>
<a id="pgfId-1097682"></a>Use the <code>fmcsweepsigma</code> parameter to <code>yes</code> to enable sweeping of variations from 3 sigma to a high sigma achieved with the number of samples in stages. It allows to get the entire trend in a single FMC run instead of running multiple simulations for 3 sigma, 4 sigma, 5 sigma and 6 sigma separately.</p>
<p>
<a id="pgfId-1097683"></a>The following example shows how <code>fmcsweepsigma</code> is specified in the montecarlo statement:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097684"></a>mc1 montecarlo fmcmethod=worstsample numruns=1e6 fmcnumtailsamples=14 <br /><strong>fmcsweepsigma=yes</strong> {tran tran stop=2n }</pre>

<p>
<a id="pgfId-1097685"></a>When running high sigma simulation is too expensive, this sigma sweeping based on lower sampling numbers can provide an idea of high sigma.</p>
<p>
<a id="pgfId-1097686"></a>When <code>fmcsweepsigma</code> is enabled, the simulation saves a file named <code>worst_by_stage_*.csv</code>. You can post-process this file with a python script <code>plot_sweep_sigma.py</code> to generate the sigma trend plots.</p>

<h4><em>
<a id="pgfId-1097687"></a>Related Topic</em></h4>

<p>
<a id="pgfId-1097688"></a>plot_sweep_sigma</p>

<h4>
<a id="pgfId-1097690"></a><a id="74534"></a>Specifying Other Parameters for Fast Monte Carlo</h4>

<p>
<a id="pgfId-1097691"></a>The following table describes other Fast Monte Carlo parameters supported by Spectre.</p>

<p>
<a id="pgfId-1097715"></a></p>
<table class="webflareTable" id="#id1097692">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097694">
<a id="pgfId-1097694"></a>Parameter</span>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097696">
<a id="pgfId-1097696"></a>Description</span>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097698"></a><code>fmcconfidence=0.95</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097700"></a>Specifies the confidence value in the range <code>0.5</code> to <code>1</code>. Default value is <code>0.95</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097702"></a><code>fmcinitruns=50</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097704"></a>Specifies the number of runs in Fast Monte Carlo initial group required to build the model.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097706"></a><code>fmcnumfails=0</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097708"></a>Stops a certain spec during Fast Monte Carlo process when the number of failed iterations reach the value set for this parameter. </p>
<p>
<a id="pgfId-1097709"></a>By default, Fast Monte Carlo does not check failed iterations.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097711"></a><code>fmcdumpcontribution=0</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097713"></a>Saves device mismatch contribution into the default Fast Monte Carlo file, <code>netlist.fmc.log</code>, in the descending order.</p>
<p>
<a id="pgfId-1097714"></a>Specify a positive value to save the number of devices for contribution. Specify a negative value to save the contribution for all devices. Specify zero to turn off the output.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1097717"></a><a id="13528"></a>Enable Moments in Fast Monte Carlo</h4>

<p>
<a id="pgfId-1097718"></a>The Fast Monte Carlo analysis is designated to identify the worst samples at both tails of distribution so that the moments are not supported by default. It can support the moments by increasing the default value of the <code>fmcinitruns</code> parameter from <code>50</code> to<code> 1000</code>. You can define this parameter explicitly in Monte Carlo statement to override the default number.</p>
<p>
<a id="pgfId-1097719"></a>When the following statement is set, the moments computation for target goal distributions is enabled.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097720"></a>mc1 montecarlo numruns=1e+6 firstrun=1 seed=12345 variations=all <br />    donominal=no savefamilyplots=no <br />    fmcmethod=worstsample fmcsigma=4.2 fmcmoments=yes  {<br />      tran tran step=1p stop=tran_time autostop=yes method=gear2<br />}</pre>

<p>
<a id="pgfId-1097721"></a>Initial group of size 1000 samples is used to compute the moments.</p>
<p>
<a id="pgfId-1097722"></a>When simulation is done, the information about moments of 1000 samples is saved in the last section of output file of <code>*.fmc.log</code> as given below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097723"></a>FMC moments of spec distributions:<br />Spec: tpd<br />Mean = 1.2226e-11<br />Variance = 1.49197e-24<br />Stddev = 1.22146e-12<br />Skewness = 0.662279<br />Kurtosis = 0.981272</pre>
<h4>
<a id="pgfId-1097725"></a><a id="95165"></a>Yield Estimation with Brute Force Monte Carlo</h4>

<p>
<a id="pgfId-1097726"></a>To estimate the sigma for the measurement goal with much fewer samples, you can use the <code>spectre_yieldest</code> command. This command runs the Brute Force Monte Carlo simulation.</p>
<p>
<a id="pgfId-1097727"></a>Syntax:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097728"></a>spectre_yieldest [spectre_cmds...] [yieldest_cmds...] netlist_with_mc</pre>

<p>
<a id="pgfId-1097729"></a>where,</p>
<p>
<a id="pgfId-1097730"></a><code>spectre_cmds</code> can be <code>+aps</code> <code>+mt=2</code> </p>
<p>
<a id="pgfId-1097731"></a><code>yieldest_cmds</code> can be one or more of the following:</p>
<ul><li style="list-style-type: none;background-image: none;"><ul><li>
<a id="pgfId-1097732"></a><code>-n NUMRUNS</code> specifies the total number of Monte Carlo iterations to predict yield estimation. Default is 3000.</li><li>
<a id="pgfId-1097733"></a><code>-s SEED </code>specifies the seed for Monte-Carlo run (overrides netlist setting).</li><li>
<a id="pgfId-1097734"></a><code>-c CONF</code> specifies the confidence level for confidence interval, default is 0.95 (95%).</li><li>
<a id="pgfId-1097735"></a><code>-clean</code> does a clean rerun of Spectre even if the previous simulation result exist. By default, if OUTDIR exists and a previous <code>yieldest</code> output directory exists, it will reuse previous simulation results. Runs incrementally only if needed.</li><li>
<a id="pgfId-1097736"></a><code>-plot</code> draws the estimated QQ plot for each goal.</li><li>
<a id="pgfId-1097737"></a><code>-l LOGNAME</code> specifies the yield estimation log file name.</li><li>
<a id="pgfId-1097738"></a><code>-o OUTDIR</code> specifies the yield estimation output directory.</li></ul></li></ul>






<p>
<a id="pgfId-1097739"></a><code>netlist_with_mc</code> is a regular netlist file that contains Monte Carlo analysis and statistical target (goal) definition. The netlist or configure file that contains the Monte Carlo analysis and the target goal has to be specified at the end of the command line.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1097740"></a>For consistent results between Fast Monte Carlo and Brute Force Monte Carlo, ensure that the <code>sampling</code>, <code>firstrun</code>, and <code>seed</code> parameters have the same values for both simulations. In Spectre, the default value of sampling method is <code>standard</code>. The default method in ADE is <code>lds</code>.</div>

<h3>
<a id="pgfId-1097742"></a><a id="70525"></a>Setup to Enhance the Performance of a Fast Monte Carlo Simulation</h3>

<p>
<a id="pgfId-1097743"></a>The run time is truly critical when the sampling number of Monte Carlo runs a million times for a high sigma requirement. You can use the following features to enhance the performance of a Fast Monte Carlo run:</p>
<p>
<a id="pgfId-1097747"></a><a href="spectreFMC.html#72071">Distributing a Fast Monte Carlo Run</a></p>
<p>
<a id="pgfId-1097751"></a><a href="spectreFMC.html#61273">Parameters to Accelerate Performance</a></p>
<p>
<a id="pgfId-1097755"></a><a href="spectreFMC.html#11101">Enabling AutoStop to Save Run Time</a></p>

<h4>
<a id="pgfId-1097757"></a><a id="72071"></a>Distributing a Fast Monte Carlo Run</h4>

<p>
<a id="pgfId-1097758"></a>The distribution process can be launched by +mp specified in Spectre command line. It is always recommended to enable <code>+mp</code> for Fast Monte Carlo to build up the model and predict worst samples with multiple workers to achieve the best performance speedup.</p>
<p>
<a id="pgfId-1097759"></a>The Fast Monte Carlo analysis supports three distribution mechanisms.</p>
<ul><li>
<a id="pgfId-1097760"></a>Job submission in farm with <code>lsf</code>, <code>sge</code> or <code>nc</code></li><li>
<a id="pgfId-1097761"></a>Using <code>rsh</code> and <code>ssh</code> on theo remote systems</li><li>
<a id="pgfId-1097762"></a>Using <code>fork</code> to create multiple jobs on a single system</li></ul>


<p>
<a id="pgfId-1097763"></a>When using <code>fork</code> in distribution mode on a terminal of the requested farm machine, add <code>+mplauncher=ksh</code> in the command line to run all distributed processes on the same machine locally. Otherwise, Spectre launches multiple processes when it detects a farm environment.</p>

<h4>
<a id="pgfId-1097765"></a><a id="61273"></a>Parameters to Accelerate Performance</h4>

<p>
<a id="pgfId-1097766"></a>You can add the following parameters in the Monte Carlo statement to accelerate the performance of a simulation:</p>

<p>
<a id="pgfId-1097781"></a></p>
<table class="webflareTable" id="#id1097767">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097769">
<a id="pgfId-1097769"></a>Parameter</span>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097771">
<a id="pgfId-1097771"></a>Description</span>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097773"></a><code>fmcmode=fast</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097775"></a>The FMC mode to control the balance between performance and accuracy. Possible values are <code>fast</code> and <code>conservative</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097777"></a><code>fmcmaxbufsize=1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097779"></a>Specifies the FMC maximum buffer size. Default value is <code>1GB</code>.</p>
<p>
<a id="pgfId-1097780"></a>For each process to store and process the sampling data, Spectre allocates memory of the size set by <code>fmcmaxbufsize</code>. If the assigned buffer size is less than the required size, the run time is limited due to the insufficient memory size. You can set <code>fmcmaxbufsize</code> to a larger size according to the physical memory size of the host to speed up the performance. Spectre automatically reduces the buffer size to the required size if <code>fmcmaxbufsize</code> is more than the size required.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1097783"></a><a id="11101"></a>Enabling AutoStop to Save Run Time</h4>

<p>
<a id="pgfId-1097784"></a>The target goal is defined by the <code>.measurement</code> statement. Most of time, the measurements are achieved prior to the stop time set in transient. You can stop the transient simulation once the measurements are completed to save the simulation time further. </p>
<p>
<a id="pgfId-1097785"></a>Alternatively, enable auto-stop by setting <code>autostop=yes</code> in the transient statement.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097786"></a>tran tran step=1p stop=tran_time autostop=yes</pre>
<h3>
<a id="pgfId-1097788"></a><a id="44999"></a>Post-Process Fast Monte Carlo Data</h3>

<p>
<a id="pgfId-1097789"></a>Spectre provides the following two commands to let you post process the Monte Carlo data:</p>
<p>
<a id="pgfId-1097793"></a><a href="spectreFMC.html#62288">spectre_fmcverifier</a></p>
<p>
<a id="pgfId-1097797"></a><a href="spectreFMC.html#19067">plot_sweep_sigma</a></p>

<h4>
<a id="pgfId-1097799"></a><a id="62288"></a>spectre_fmcverifier</h4>

<p>
<a id="pgfId-1097800"></a>This command lets you view the sample data distribution for the Brute Force Monte Carlo and Fast Monte Carlo, use the <code>spectre_fmcverifier</code> binary utility. It plots the QQ plot and histogram plot.</p>
<p>
<a id="pgfId-1097801"></a>Syntax</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097802"></a>spectre_fmcverifier [-h] [-mc MC] [-mcdir MTCDIR] [-csvbfmc CSVBFMC] <br />[-legendloc LEGENDLOC] [-worstnum WORSTNUM]<br />[-fmc FMC] [-csvfmc CSVFMC] [-fmcnumruns FMCNUMRUNS] [-goal GOAL] <br />[-qqplot] [-histo] [-plotsigma] [-plotall] [-switch]</pre>

<p>
<a id="pgfId-1097803"></a>Options</p>

<p>
<a id="pgfId-1097872"></a></p>
<table class="webflareTable" id="#id1097804">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097806">
<a id="pgfId-1097806"></a>Parameter</span>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097808">
<a id="pgfId-1097808"></a>Description</span>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097810"></a>-h</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097812"></a>Prints this help message and exits.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097814"></a>-mc MC </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097816"></a>Specifies brute force montecarlo results mt0 file or MC scalar file (mcdat file).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097818"></a>-mcdir MCDIR</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097820"></a>Specifies the results directory for brute force montecarlo, the binary collects all the mt0 files in the directory.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097822"></a>-csvbfmc CSVBFMC</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097824"></a>Specifies brute force montecarlo results in CSV file.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097826"></a><code>-legendloc LEGENDLOC</code></p>
<p>
<a id="pgfId-1097827"></a><code></code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097829"></a>Specifies the legend location. Default is <code>UL</code> (upper left). You can change it to <code>LR</code> (lower right), <code>LL</code>, or <code>UR</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097831"></a>-worstnum WORSTNUM</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097833"></a>Specifies the worst #num samples to search from brute force montecarlo results mt0.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097835"></a><code>-fmc FMC</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097837"></a>Specifies the Spectre public logs. For example, </p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097838"></a>-fmc &quot;log1 log2&quot;</pre>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097840"></a>-csvfmc CSVFMC</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097842"></a>Specifies FMC result in .csv file. You also needs to provide fmc numruns by <code>-fmcnumruns</code>, to enable the tool to plot qqplot.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097844"></a>-fmcnumruns FMCNUMRUNS</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097846"></a>Specifies FMC numruns by this parameter if want to plot qqplot by read fmc data through csv file. This number must be smaller or equal to the BFMC total numruns.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097848"></a>-goal GOAL</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097850"></a>Specifies the FMC goal(s) want to check. For example, </p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097851"></a>-goal &quot;spike droop&quot;</pre>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097853"></a><code>-qqplot </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097855"></a>Plots QQ-plots for FMC and BFMC. Comparison table is printed by default.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097857"></a>-histo</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097859"></a>Plots a histogram for BFMC data.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097861"></a>-plotsigma</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097863"></a>Plots a sigma distribution for different FMC number runs.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097865"></a><code>-plotall</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097867"></a>Plots both QQ-plot and histogram.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097869"></a>-switch</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097871"></a>Switches QQ-plot X/Y axis as sigma vs goal, instead of goal vs sigma.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1097874"></a><a id="19067"></a>plot_sweep_sigma</h4>

<p>
<a id="pgfId-1097875"></a>This python script post processes the data from FMC sigma sweeping. The output file <code>worst_by_stage_*.csv</code> is generated from FMC simulation with the goal name.</p>
<p>
<a id="pgfId-1097876"></a>A file with <code>*_H</code> in its name contains the sigma values on maximum boundary. A file with <code>*_L</code> in its name contains the sigma values on minimum boundary.</p>
<p>
<a id="pgfId-1097877"></a>Syntax</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097878"></a>plot_sweep_sigma.py [options]</pre>

<p>
<a id="pgfId-1097879"></a>Options</p>

<p>
<a id="pgfId-1097906"></a></p>
<table class="webflareTable" id="#id1097880">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097882">
<a id="pgfId-1097882"></a>Parameter</span>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1097884">
<a id="pgfId-1097884"></a>Description</span>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097886"></a>-h, --help</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097888"></a>Displays this help message and exits</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097890"></a>FILE, --file=FILE</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097892"></a> Worst by stage file.</p>

</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097895"></a>-l, --left</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097897"></a>Extrapolates left tail.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097899"></a><code>-m MEASURE, <br />--measure=MEASURE</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097901"></a>Name of the measurement.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097903"></a>-q, --quiet</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1097905"></a>Specifies whether to print status messages to stdout</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1097907"></a>Examples:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097908"></a>%cdspython -64 ../bin/plot_sweep_sigma.py <br />-f out_sweep_sigma_1M_mp32/worst_by_stage_tpd_H.csv -m tpd</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097909"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1097910"></a>%cdspython -64 ../bin/plot_sweep_sigma.py -h</pre>

<p>
<a id="pgfId-1097911"></a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="spectrex.html" id="prev" title="The Spectre X Circuit Simulator">The Spectre X Circuit Simulato ...</a></em></b><b><em><a href="chap3.html" id="nex" title="SPICE Compatibility">SPICE Compatibility</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;⠀ </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>