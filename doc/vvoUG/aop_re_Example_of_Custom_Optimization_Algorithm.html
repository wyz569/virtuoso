
<html><head><title>Example of Custom Optimization Algorithm</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="urajput" />
<meta name="CreateDate" content="2023-10-30" />
<meta name="CreateTime" content="1698677527" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes advanced simulation run modes provided by Virtuoso Variation Option" />
<meta name="DocTitle" content="Virtuoso Variation Option User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Example of Custom Optimization Algorithm" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="vvoUG" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-10-30" />
<meta name="ModifiedTime" content="1698677527" />
<meta name="NextFile" content="aop_tk_Integrating_a_Custom_Optimizer_into_ADE_Assembler.html" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="aop_re_Advanced_Optimizers_in_ADE_Assembler.html" />
<meta name="c_product" content="Virtuoso Analog Design Environment" />
<meta name="Product" content="Virtuoso Analog Design Environment" />
<meta name="ProductFamily" content="Virtuoso Analog Design Environment" />
<meta name="ProductVersion" content="IC23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Virtuoso Variation Option User Guide -- Example of Custom Optimization Algorithm" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="IC23.1" />
<meta name="SpaceKey" content="vvoUGIC231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="vvoUGTOC.html">Contents</a></li><li><a class="prev" href="aop_re_Advanced_Optimizers_in_ADE_Assembler.html" title="Advanced Optimizers in ADE Assembler">Advanced Optimizers in ADE Ass ...</a></li><li style="float: right;"><a class="viewPrint" href="vvoUG.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="aop_tk_Integrating_a_Custom_Optimizer_into_ADE_Assembler.html" title="Integrating a Custom Optimizer into ADE Assembler">Integrating a Custom Optimizer ...</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Virtuoso Variation Option User Guide<br />Product Version IC23.1, November 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<a id="Filename:re_Example_of_Custom_Optimization_Algorithm" title="Example of Custom Optimization Algorithm"></a><h2>
<a id="pgfId-1071682"></a><a id="33355"></a>Example of Custom Optimization Algorithm</h2>

<p>
<a id="pgfId-1071734"></a>You can create a custom optimization algorithm either in C++ or Python.</p>
<p>
<a id="pgfId-1071826"></a>The following piece of code shows an example of the custom optimization algorithm written in Python.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071972"></a># ***************************************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071973"></a>#&#160;&#160;              Copyright 2023 Cadence Design Systems, Inc.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071974"></a>#&#160;&#160;                         All Rights Reserved.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071975"></a>#</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071976"></a># This work cannot be republished or copied in its original form</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071977"></a># without prior written permission from Cadence Design Systems, Inc.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071978"></a>#</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071979"></a># Permission is granted to modify this code for the purpose of</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071980"></a># developing new optimizers to run within Virtuoso Studio.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071981"></a># ***************************************************************************</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076940"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076944"></a>import dso </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076945"></a>import numpy as np</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076946"></a>import random</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076947"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076948"></a>random.seed(1)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076949"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076950"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076951"></a>class RakOptimizer(dso.BaseOptimizer):</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076952"></a>    def __init__(self):</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076953"></a>        super().__init__()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076954"></a>        self.optimizer_info.set_optimizer_name(name=&#39;RAK Optimizer&#39;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076955"></a>        self.optimizer_info.set_hyperparameter_property_range(</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076956"></a>            hp=&#39;batchSize&#39;,</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076957"></a>            hp_default=2,</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076958"></a>            hp_min=2,</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076959"></a>            hp_step=1,</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076960"></a>            hp_max=1000,</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076961"></a>            hp_description=&#39;Controls Batch Size&#39;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076962"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076963"></a>    # def pre_processing(self):</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076964"></a>    #     pass</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076965"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076966"></a>    def get_points(self):</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076967"></a>        point_dic = self.domain.sample(size=self.hyper_params[&#39;batchSize&#39;])</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076968"></a>        point_array = point_dic.parse_into_object(out_type=np.ndarray)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076969"></a>        ret = dso.GetPointsReturnType()</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076970"></a>        ret.parse_from_object(domain=self.domain, samples=point_array)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076971"></a>        return ret </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076972"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076973"></a>    def record_evaluations(self, evaluation_result):</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076974"></a>        pass</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076975"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076976"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1076977"></a>if __name__ == &#39;__main__&#39;:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1071982"></a>    RakOptimizer().run()</pre>
<h3>
<a id="pgfId-1072554"></a>Methods Used in the Custom Optimization Algorithm Example</h3>

<p>
<a id="pgfId-1071839"></a>In the example of custom optimization algorithm, following methods are used:</p>

<ul><li>
<a id="pgfId-1072189"></a><code>__init__()</code><br />
<a id="pgfId-1072208"></a>It is a Python constructor that is loaded with the AOP framework. It contains essential information about the optimization algorithm, such as name, description, and details of hyperparameters. Note that specific design space information is not accessible at this stage because simulation run in ADE Assembler has not started yet.<br />
<a id="pgfId-1072722"></a>The details of optimizer hyperparameters can be defined as follows.<pre class="webflare-pre-block webflare-courier-new" id="#id1073050">
<a id="pgfId-1073050"></a>self.optimizer_info.set_hyperparameter_property_range(</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1073051">
<a id="pgfId-1073051"></a>            hp=&#39;Batch Size&#39;,</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1073052">
<a id="pgfId-1073052"></a>            hp_default=100,</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1073053">
<a id="pgfId-1073053"></a>            hp_min=10,</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1073054">
<a id="pgfId-1073054"></a>            hp_step=1,</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1073055">
<a id="pgfId-1073055"></a>            hp_max=1000,</pre><pre class="webflare-pre-block webflare-courier-new" id="#id1073041">
<a id="pgfId-1073041"></a>            hp_description=&#39;Specifies the maximum number of points that can be submitted by optimizer during one iteration&#39;)</pre>
<a id="pgfId-1073072"></a>In this example, a hyperparameter named <em>Batch Size</em> is defined. The default value of this parameter is <code>100</code>. The minimum and maximum values for this hyperparameters is <code>10</code> and <code>1000</code>, respectively. The tooltip for this hyperparameters reads: <em>Specifies the maximum number of points that can be submitted by optimizer during one iteration.</em><br />
<a id="pgfId-1073386"></a>This hyperparameter option is displayed in the <em>rak_optimizer.py</em> <em>HyperParameters</em> section of the AOP Options form, as follows:<br />
<a id="pgfId-1073588"></a><div class="webflare-div-image">
<img width="635" height="650" src="images/aop-3.gif" /></div>
<a id="pgfId-1073546"></a>Where, <code>rak_optimizer.py</code> is the name of the custom optimization algorithm currently selected in the <em>Optimizers</em> drop-down list.</li><li>
<a id="pgfId-1072211"></a><code>pre_processing()</code><br />
<a id="pgfId-1073755"></a>This method is used to initialize settings that are necessary for the optimization run. Information about design space is available at this stage because optimization run is started in ADE Assembler.</li><li>
<a id="pgfId-1072214"></a><code>get_points()</code><br />
<a id="pgfId-1072217"></a>This method is used by the AOP framework to request the optimization algorithm for the points to simulate.</li><li>
<a id="pgfId-1072220"></a><code>record_evaluations()</code><br />
<a id="pgfId-1074143"></a>This method is used by AOP framework to return the merit values associated with the simulated points. In this example, the optimizer performs random sampling and does not use any information returned from ADE Assembler.</li></ul>






























<h4><em>
<a id="pgfId-1072182"></a>Related Topics</em></h4>

<p>
<a id="pgfId-1074830"></a><a href="aop.html#88868">Advanced Optimization</a></p>
<p>
<a id="pgfId-1074834"></a><a href="aop_Advantages_of_Advanced_Optimization.html#17495">Advantages of Advanced Optimization</a></p>
<p>
<a id="pgfId-1074838"></a><a href="vvoForms_re_AOP_Options_Form.html#52259">AOP Options Form</a></p>
<p>
<a id="pgfId-1074842"></a><a href="aop_tk_Running_Advanced_Optimization.html#14714">Running Advanced Optimization</a></p>
<p>
<a id="pgfId-1075948"></a><a href="aop_tk_Integrating_a_Custom_Optimizer_into_ADE_Assembler.html#26995">Integrating a Custom Optimizer into ADE Assembler</a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="aop_re_Advanced_Optimizers_in_ADE_Assembler.html" id="prev" title="Advanced Optimizers in ADE Assembler">Advanced Optimizers in ADE Ass ...</a></em></b><b><em><a href="aop_tk_Integrating_a_Custom_Optimizer_into_ADE_Assembler.html" id="nex" title="Integrating a Custom Optimizer into ADE Assembler">Integrating a Custom Optimizer ...</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;⠀ </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>