
<html><head><title>Determining Which Via the Router Will Use</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="parula" />
<meta name="CreateDate" content="2023-10-17" />
<meta name="CreateTime" content="1697541421" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes how to use Virtuoso Space-based Router Tcl commands" />
<meta name="DocTitle" content="Virtuoso Space-based Router Command Reference" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Determining Which Via the Router Will Use" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="vsrcmdref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-10-17" />
<meta name="ModifiedTime" content="1697541421" />
<meta name="NextFile" content="RoutePrepEnv_Using_Via_Abstraction.html" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="RoutePrepEnv_Valid_Routing_Vias.html" />
<meta name="c_product" content="Virtuoso Layout Suite" />
<meta name="Product" content="Virtuoso Layout Suite" />
<meta name="ProductFamily" content="Virtuoso Layout Suite" />
<meta name="ProductVersion" content="IC23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Virtuoso Space-based Router Command Reference -- Determining Which Via the Router Will Use" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="task" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="Routing Environment" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="IC23.1" />
<meta name="SpaceKey" content="vsrcmdrefIC231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="vsrcmdrefTOC.html">Contents</a></li><li><a class="prev" href="RoutePrepEnv_Valid_Routing_Vias.html" title="Routing Vias">Routing Vias</a></li><li style="float: right;"><a class="viewPrint" href="vsrcmdref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="RoutePrepEnv_Using_Via_Abstraction.html" title="Using Via Abstraction">Using Via Abstraction</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Virtuoso Space-based Router Command Reference<br />Product Version IC23.1, September 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<a id="Filename:Determining_Which_Via_the_Router_Will_Use" title="Determining Which Via the Router Will Use"></a><h2>
<a id="pgfId-1182891"></a><a id="69178"></a>Determining Which Via the Router Will Use</h2>

<p>
<a id="pgfId-1237612"></a>The router computes the cost of the available vias based on each via&#8217;s bounds on metal and cut layers, extension values, preferred orientation, and origin offset. A via with the smallest footprint and with longer extensions in the preferred routing direction will have the lowest cost. Vias with a lower cost are preferred for routing.</p>
<p>
<a id="pgfId-1237635"></a>The selection of vias can be further controlled as described in the following sections:</p>
<ul><li>
<a id="pgfId-1237616"></a><a href="RoutePrepEnv_Determining_Which_Via_the_Router_Will_Use.html#66904">Advanced Via Extension Control and Selection</a></li><li>
<a id="pgfId-1237620"></a><a href="RoutePrepEnv_Determining_Which_Via_the_Router_Will_Use.html#38933">Routing with Aligned Single-Cut Vias</a></li><li>
<a id="pgfId-1182892"></a><a href="RoutePrepEnv_Determining_Which_Via_the_Router_Will_Use.html#58924">Routing with On-Wire Multi-Cut Vias</a></li></ul>



<h3>
<a id="pgfId-1237649"></a><a id="66904"></a>Advanced Via Extension Control and Selection</h3>

<p>
<a id="pgfId-1182898"></a>To further control the router&#8217;s selection of vias, you can specify preferred extension directions and origin offsets, and also save a preferred via selection order for routing. </p>
<p>
<a id="pgfId-1182899"></a>To use these features, </p>
<ol><li>
<a id="pgfId-1182900"></a>Enable the use of these features by setting the <code>db.use_separate_pref_ext_dir</code><a id="marker-1190348"></a> environment variable to <code>true</code>.<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1182901">
<a id="pgfId-1182901"></a>setvar db.use_separate_pref_ext_dir true</pre></li><li>
<a id="pgfId-1182905"></a>Set constraints, as described in <a href="RoutePrepEnv_Determining_Which_Via_the_Router_Will_Use.html#36386">&#8220;Specifying Via Preferences&#8221;</a>.</li><li>
<a id="pgfId-1182908"></a>(Optional) Customize the sorted list of valid vias, as described in <a href="RoutePrepEnv_Determining_Which_Via_the_Router_Will_Use.html#18052">&#8220;Reviewing and Changing the Sorted List of Valid Vias&#8221;</a>.</li></ol>






<h4>
<a id="pgfId-1182911"></a><a id="36386"></a>Specifying Via Preferences </h4>

<p>
<a id="pgfId-1182912"></a>By setting the following constraints, you instruct the router to assign a lower cost to vias with your specified preferred extension direction, extension alignment, and/or origin offset.</p>
<ul><li>
<a id="pgfId-1182916"></a><a actuate="user" class="URL" href="../vsrconstraint/constr_routing_re_preferredExtensionDirection.html" show="replace" xml:link="simple">preferredExtensionDirection</a><br />
<a id="pgfId-1182917"></a>When this constraint is set, a via with extensions aligned to the preferredExtensionDirection of the lower and upper metal layers will have the lowest cost and will be preferred for routing over another via that has the same number of cuts and the same extension dimensions but violates this constraint.</li><li>
<a id="pgfId-1182921"></a><a actuate="user" class="URL" href="../vsrconstraint/constr_routing_re_inlineViaPreferred.html" show="replace" xml:link="simple">inlineViaPreferred</a><br />
<a id="pgfId-1182922"></a>By setting this constraint to <code>true</code>, the preference is for inline vias, with longer extensions aligned with the longer dimension of the cut bound, and will override the preferred extension direction of the upper layer. </li><li>
<a id="pgfId-1182926"></a><a actuate="user" class="URL" href="../vsrconstraint/constr_routing_re_preferredViaOrigin.html" show="replace" xml:link="simple">preferredViaOrigin</a><br />
<a id="pgfId-1182927"></a>By default, the via origin does not affect the cost of a via. By setting this constraint, you can assign a preference (lower cost) to centered-at-origin vias or offset vias.</li></ul>






<h4>
<a id="pgfId-1182930"></a><a id="18052"></a>Reviewing and Changing the Sorted List of Valid Vias</h4>

<p>
<a id="pgfId-1182934"></a>To get the sorted list of valid routing vias, use <a href="routeT_re_get_sorted_route_via_list.html#52237">get_sorted_route_via_list</a>. The returned list will include all valid routing vias for the design rule spec (default) or a given rule spec, sorted in order of increasing cost, as seen by the router. When <code>db.use_separate_pref_ext_dir</code><a id="marker-1190356"></a> is <code>true</code>, then settings for <code>preferredExtensionDirection</code>, <code>inlineViaPreferred</code>, and <code>preferredViaOrigin</code> constraints will be considered when determining costs, otherwise those settings are ignored.</p>
<p>
<a id="pgfId-1190378"></a>In addition, you can explicitly set the via preference order, by setting the list of valid routing vias (<code>validRoutingVias</code>) to your own ordered list of valid routing vias and setting <code>db.preserve_routing_via_order</code> to <code>true</code>. When <code>db.preserve_routing_via_order</code> is <code>true</code>, the router will select vias in the order specified by the list of valid routing vias and will assume that the cost of vias appearing earlier in the list will be lower than the cost of vias appearing later, irrespective of the via dimensions or any other parameters. </p>

<h3>
<a id="pgfId-1237558"></a><a id="38933"></a>Routing with Aligned Single-Cut Vias</h3>

<p>
<a id="pgfId-1237559"></a>By default, the router will use vias with extensions in the preferred routing direction for the respective metal layers. To route using single cut vias with aligned extensions in the direction of routing, set the <a href="../vsrcmdref/environ_re_align_vias.html">droute.align_vias</a> environment variable to <code>true</code> before detail routing.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1237561"></a>setvar droute.align_vias true</pre>

<p>
<a id="pgfId-1237562"></a>The aligned vias must be included in the <code>validRoutingVias</code> constraint or created using <a href="routeT_re_create_derived_vias.html#22937">create_derived_vias</a>.</p>

<div class="ft-figtabl-title">
<a id="pgfId-1237566"></a>Illustrations for droute.align_vias</div>
<div class="webflare-div-image">
<img width="668" height="162" src="images/RoutePrepEnv-5.gif" /></div>
<h3>
<a id="pgfId-1237591"></a><a id="58924"></a>Routing with On-Wire Multi-Cut Vias</h3>

<p>
<a id="pgfId-1237593"></a>To prefer routing with on-wire vias, set the <a href="environ_re_offset_vias.html#79602"><h-hot>offset_vias</h-hot><code></code></a> environment variable to <code>true</code> before detail routing.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1237594"></a>setvar droute.offset_vias true</pre>

<p>
<a id="pgfId-1237595"></a>The vias must be included in the <code>validRoutingVias</code> constraint or created using <a href="routeT_re_create_derived_vias.html#22937">create_derived_vias</a>.</p>

<div class="ft-figtabl-title">
<a id="pgfId-1237812"></a>Illustrations for droute.offset_vias true</div>
<div class="webflare-div-image">
<img width="668" height="182" src="images/RoutePrepEnv-6.gif" /></div>
<h4><em>
<a id="pgfId-1348179"></a>Related Topics</em></h4>

<p>
<a id="pgfId-1348183"></a><a href="RoutePrepEnv.html#74538">Preparing the Routing Environment</a></p>
<p>
<a id="pgfId-1348360"></a><a href="RoutePrepEnv_Valid_Routing_Vias.html#76001">Routing Vias</a></p>
<p>
<a id="pgfId-1348364"></a><a href="RoutePrepEnv_Using_Via_Abstraction.html#64732">Using Via Abstraction</a></p>
<p>
<a id="pgfId-1348368"></a><a href="RoutePrepEnv_Controlling_Via_Stacking.html#69783">Controlling Via Stacking</a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="RoutePrepEnv_Valid_Routing_Vias.html" id="prev" title="Routing Vias">Routing Vias</a></em></b><b><em><a href="RoutePrepEnv_Using_Via_Abstraction.html" id="nex" title="Using Via Abstraction">Using Via Abstraction</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;⠀ </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>