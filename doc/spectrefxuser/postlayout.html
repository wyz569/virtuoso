
<html><head><title>EMIR Analysis and Post-Layout Simulations</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="namratam" />
<meta name="CreateDate" content="2023-08-31" />
<meta name="CreateTime" content="1693487220" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the Spectre FX Simulator." />
<meta name="DocTitle" content="Spectre FX Circuit Simulator User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="EMIR Analysis and Post-Layout Simulations" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-4.0.0" />
<meta name="Keyword" content="spectrefxuser" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2023-08-31" />
<meta name="ModifiedTime" content="1693487220" />
<meta name="NextFile" content="postlayout_re_Post-layout_Simulation_Methodologies.html" />
<meta name="Order" content="1" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="probing_measuring.html" />
<meta name="c_product" content="Spectre" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="23.1" />
<meta name="RightsManagement" content="Copyright 2023 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre FX Circuit Simulator User Guide -- EMIR Analysis and Post-Layout Simulations" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="23.1" />
<meta name="SpaceKey" content="spectrefxuser231" />
<meta name="webflare-version" content="2.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" />


  <script>/*<![CDATA[*/
 document.addEventListener("DOMContentLoaded", function(event) {  document.querySelectorAll("img").forEach((img, index) => {
if (img.hasAttribute("usemap")){return;}else{img.classList.add("cursorclass");} img.addEventListener("click", (e) => {if(img.hasAttribute("usemap")){            img.setAttribute("style","cursor:none;");return;};document.querySelector("#cad_image_modal").classList.add("opac");document.querySelector("#cad_image_modal_center").innerHTML = `<img style="position:absolute;top:0;bottom:0;left:0;right:0;margin: auto;max-height:95%;"  src="${e.target.src}">`;});});});
/*]]>*/</script> 




 <style>/*<![CDATA[*/
.cursorclass{cursor:pointer;}#cad_image_modal{position:fixed;left:0;top:0;width:100%;background:#00000099;overflow:hidden;height:0;opacity:0;transition: height 0ms 1s, opacity 1s 0ms;}#cad_image_modal.opac{height: 100%;opacity: 1;transition: height 0ms 0ms, opacity 1s 0ms;}#cad_image_modal span{position:fixed;right:10px;top:10px;cursor:pointer;color:#fff;}
/*]]>*/</style> 
</head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectrefxuserTOC.html">Contents</a></li><li><a class="prev" href="probing_measuring.html" title="Probing and Measuring Statements">Probing and Measuring Statemen ...</a></li><li style="float: right;"><a class="viewPrint" href="spectrefxuser.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="postlayout_re_Post-layout_Simulation_Methodologies.html" title="Post-layout Simulation Methodologies">Post-layout Simulation Methodo ...</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre FX Circuit Simulator User Guide<br />Product Version 23.1, September 2023</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>7
<a id="pgfId-1065082"></a></h1>
<h1>
<a id="pgfId-1065083"></a><hr />
<a id="12871"></a>EMIR Analysis and Post-Layout Simulations<hr />
</h1>

<p>
<a id="pgfId-1069604"></a>This section covers the following topics:</p>
<p>
<a id="pgfId-1079375"></a><a href="postlayout.html#84540">EMIR Analysis</a></p>
<p>
<a id="pgfId-1069608"></a><a href="postlayout_re_Post-layout_Simulation_Methodologies.html#83709">Post-layout Simulation Methodologies</a></p>
<p>
<a id="pgfId-1074012"></a><a href="postlayout_re_The_Parasitic_Backannotation_Flow.html#71153">The Parasitic Backannotation Flow</a></p>
<p>
<a id="pgfId-1069612"></a><a href="postlayout_re_Control_Options_for_the_Parasitic_Backannotation_Flow.html#68452">Control Options for the Parasitic Backannotation Flow</a></p>
<p>
<a id="pgfId-1075852"></a><a href="postlayout_re_Guidelines_for_Parasitic_Backannotation_Options.html#84106">Guidelines for Parasitic Backannotation Options</a></p>
<p>
<a id="pgfId-1075870"></a><a href="postlayout_tk_Probing_Signals_for_the_Parasitic_Backannotation_Flow.html#44877">Probing Signals for the Parasitic Backannotation Flow</a></p>
<p>
<a id="pgfId-1069616"></a><a href="postlayout_re_Parasitic_Backannotation_Report.html#93089">Parasitic Backannotation Report</a></p>

<h2>
<a id="pgfId-1079406"></a><a id="84540"></a>EMIR Analysis </h2>

<p>
<a id="pgfId-1079407"></a>Spectre&#174; FX provides a powerful transistor-level EMIR solution. This dynamic power net and signal net EMIR capability uses a patented technology and is designed to provide high-capacity and high-performance EMIR analyses. The Spectre FX EMIR solution provides a set of advanced features covering dynamic and static EMIR, power gate support, and differential IR drop. The flow is fully integrated into Virtuoso&#174; ADE Explorer and Virtuoso&#174; ADE Assembler and the results can be post-processed with Voltusâ„¢- Fi Custom Power Integrity Solution.</p>

<h4><em>
<a id="pgfId-1079408"></a>Related Topics</em></h4>

<p>
<a id="pgfId-1079412"></a><a href="postlayout.html#62392">Spectre FX EMIR Technology, Product, and Flow Overview</a></p>
<p>
<a id="pgfId-1079416"></a><a href="postlayout.html#64494">Getting Started with Spectre FX EMIR Analysis</a></p>
<p>
<a id="pgfId-1079420"></a><a href="postlayout.html#73763">Power Gate Support</a></p>
<p>
<a id="pgfId-1079424"></a><a href="postlayout.html#42145">Handling the Complexity of DSPF/SPEF files</a></p>
<p>
<a id="pgfId-1079428"></a><a href="postlayout.html#71161">Advanced Analyses</a></p>

<h2>
<a id="pgfId-1079430"></a><a id="62392"></a>Spectre FX EMIR Technology, Product, and Flow Overview</h2>

<p>
<a id="pgfId-1079431"></a>In an EMIR flow, a circuit is evaluated together with the parasitic resistor and capacitor network, which models the IR drop or the EM effect. There are two general approaches of solving such a problem:</p>
<ul><li>
<a id="pgfId-1079432"></a><strong>Direct EMIR analysis - </strong>When high accuracy is needed, a brute-force simulation of the entire system (circuit plus parasitic resistances and capacitances) can be performed to accurately calculate the EMIR of any net. The EMIR simulation performance and capacity is subject to the limitation of the circuit simulator being used.</li><li>
<a id="pgfId-1079433"></a><strong>Iterated EMIR analysis - </strong>In order to conduct EMIR simulation on circuits with much larger power and signal nets within a much shorter time, an alternative is to decouple the nonlinear circuit simulation from the linear RC net analysis. User can iterate the linear RC net analysis by modifying the layout, however, the nonlinear circuit simulation is performed only once. The decoupling of the linear RC nets from the nonlinear circuit is not mathematically equivalent to the original design and certain inaccuracy is introduced, however, the user receives the benefit of simulation performance and capacity.<br />
<a id="pgfId-1079958"></a><div class="webflare-div-image">
<img width="668" height="315" src="images/postlayout-2.gif" /></div></li></ul>





<p>
<a id="pgfId-1079959"></a>For high accuracy EMIR analysis of small design blocks, or designs with smaller numbers of RC nets, direct EMIR analysis is recommended. </p>
<p>
<a id="pgfId-1079960"></a>To gain higher performance and higher capacity on medium-to-large designs, the iterated EMIR analysis method is recommended.</p>
<p>
<a id="pgfId-1079961"></a>The Spectre FX EMIR flow requires a complete testbench that contains the DSPF files (with the parasitic and instance sections describing the circuit to be analyzed) stimuli, device, and models. .</p>
<p>
<a id="pgfId-1079962"></a>Use the <code>+emir</code> option on the Spectre FX command line to enable the EMIR analysis during circuit simulation. The details of EMIR analysis, such as the type of analyses, nets to be analyzed, output to be created, are specified using an EMIR configuration file.</p>
<p>
<a id="pgfId-1079963"></a>Using either direct EMIR analysis or iterated EMIR analysis, the circuit simulation is first performed with various voltages and currents being calculated. Next, a standalone tool, <code>emirreport</code>/<code>emirutil</code>, is called to post-process the simulation results and generate the IR and EM reports. By default, the post-processing step is invoked automatically.</p>
<p>
<a id="pgfId-1079964"></a>The output of the EMIR analysis is an EMIR text/html report, which lists the EM and/or IR information of all the nets requested. In addition, <em>Voltus-Fi XL</em> can be used to visualize the IR drop and EM current violations in Virtuoso Layout Editor. </p>

<p>
<a id="pgfId-1080535"></a></p>
<div class="webflare-div-image">
<img width="668" height="519" src="images/postlayout-3.gif" /></div>

<p>
<a id="pgfId-1080536"></a>Note that while the Spectre FX EMIR flow uses the DSPF representation of the designs, it is not dependent on any post-layout backannotation or stitching capability. The flow also covers designs with power gates.</p>

<h4>
<a id="pgfId-1080537"></a>Product Overview and EMIR Flow</h4>

<p>
<a id="pgfId-1080538"></a>The EMIR product consists of the Spectre FX EMIR simulation and the <em>Voltus-Fi XL</em> visualization. The circuit and the RC network simulation are handled by Spectre FX EMIR. The result is stored in a binary database which contains the average, rms, max IR drop, and EM values. <em>Voltus-Fi </em><em>XL</em> reads the information from the binary database, evaluates whether the currents are above the limits defined in the technology file, and visualizes the results in the layout.</p>

<p>
<a id="pgfId-1080576"></a></p>
<div class="webflare-div-image">
<img width="663" height="225" src="images/postlayout-4.gif" /></div>

<p>
<a id="pgfId-1080577"></a>Different utilities are responsible for creating the IR drop and EM text reports. For advanced node designs for which the technology file format is ICT or <code>qrctechfile</code>, the utility <code>emirreport</code> (or <code>vpsbatch</code>) is used to generate the text report. For older technology nodes which use <code>emdatafile</code> format, the utility <code>emirutil</code> is used to create the text reports.</p>

<h4>
<a id="pgfId-1080578"></a>DSPF requirements</h4>

<p>
<a id="pgfId-1080579"></a>The Spectre FX EMIR flow is based on a DSPF representation of the analyzed design. The DSPF file is required to contain all electrical and geometric information needed for EMIR analysis. The following figure shows a representative DSPF netlist with all important information for EMIR being marked in color.</p>

<p>
<a id="pgfId-1080583"></a></p>
<div class="webflare-div-image">
<img width="661" height="425" src="images/postlayout-5.gif" /></div>
<h4>
<a id="pgfId-1080584"></a>EM Rule Support</h4>

<p>
<a id="pgfId-1080585"></a>EM rules are defined in DRM, and part of the technology files. The <em>Voltus-Fi </em><em>XL&#8211;</em> Spectre FX EMIR solution supports the following technology file formats.</p>
<ul><li>
<a id="pgfId-1080586"></a>ICT, ICT-EM (EM rules only)</li><li>
<a id="pgfId-1080587"></a><code>qrctechfile</code></li><li>
<a id="pgfId-1080588"></a><code>emdatafile</code></li></ul>


<p>
<a id="pgfId-1080589"></a>Advanced node technologies require special EM rules that are only supported in ICT/ICT-EM and <code>qrctechfile</code> format. Refer to the <em>Quantus QRC Techgen Reference Manual</em> for details.</p>
<p>
<a id="pgfId-1080590"></a><code>emdatafile</code> format is used for legacy technology nodes. In future, it is expected to be replaced by ICT and <code>qrctechfile</code> format.</p>
<p>
<a id="pgfId-1080591"></a>Various Cadence EMIR tools support only subsets of these techfile formats (for example, Voltus does not support ICT file, but supports <code>ICT_em</code>). <code>ICT_em</code> is the only format supported by all Cadence EMIR technologies, Voltus, EAD, and Voltus-Fi L and XL.</p>

<h3>
<a id="pgfId-1080593"></a><a id="64494"></a>Getting Started with Spectre FX EMIR Analysis</h3>

<p>
<a id="pgfId-1080594"></a>To perform EMIR analysis, first create a complete simulation testbench with the DSPF files containing the postlayout data of the design. Specify the fingered devices in the <code>instance</code> section and the parasitic resistors and capacitors in the <code>net</code> section. Use the <code>dspf_include</code> statement to read the DSPF content, as shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1080595"></a><code>dspf_include &quot;sram.spf&#160;&#160;&#160;&#160; </code>&quot;                        (Spectre syntax)<br /><code>.dspf_include &quot;sram.spf</code>  &quot;&#160;&#160;                     (SPICE syntax)</pre>

<p>
<a id="pgfId-1080597"></a><code>dspf_include</code> provides special features like port order adjustments, or handling of duplicated subcircuits, which are not available in <code>include</code>/<code>.include</code>. Therefore, do not use <code>include</code>/<code>.include</code> in the EMIR flow for including the DSPF file.</p>
<p>
<a id="pgfId-1080598"></a>Large DSPF files may be split into multiple files, for example, <code>sram.dspf</code>, <code>sram.dspf.1</code>, <code>sram.dspf.2</code>, and so on. If the top-level DSPF file (<code>sram.dspf</code>) is included with the <code>dspf_include</code> statement, Spectre FX searches for any related file (<code>sram.dspf.1</code>, <code>sram.dspf.2</code>, ...) and read them automatically.</p>
<p>
<a id="pgfId-1080600"></a>Setting up a correct postlayout simulation test bench is vital to successful EMIR analysis (see <a href="postlayout.html#42145">Handling the Complexity of DSPF/SPEF files</a>).</p>
<p>
<a id="pgfId-1080604"></a>Once the testbench is set up, you can perform a regular (non-EMIR) postlayout simulation with the <code>spectrefx</code> command to ensure that the testbench contains no error, and the circuit behavior is as expected.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1080605"></a>% spectrefx input.sp </pre>

<p>
<a id="pgfId-1080607"></a>To perform the same simulation with EMIR analysis added, you need to create and include an EMIR control file with the <code>spectrefx</code> command, as shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1080608"></a>% spectrefx +emir=emir.conf&#160;&#160;input.scs </pre>

<p>
<a id="pgfId-1080609"></a>The EMIR analyses is enabled by using the <code>+emir</code> Spectre FX command-line option. All EMIR-related commands are defined in the EMIR control file.</p>

<h4>
<a id="pgfId-1080611"></a><a id="22246"></a>EMIR Control File</h4>

<p>
<a id="pgfId-1080612"></a>EMIR analysis is performed based on the first transient analysis statement in the netlist. An EMIR control file contains all of the settings and options that are relevant to an EMIR analysis. Some of the options that can be specified using the EMIR control file are: the names of the nets to be analyzed, the type of analyses to be performed, the EMIR analysis time window, choice of direct or iterated methods, settings for RC simulation, and location of EM rule file. </p>
<p>
<a id="pgfId-1080613"></a>The following sample control file describes EMIR analysis based on the <code>X1</code> instance. A maximum IR drop analysis is performed on nets <code>VDD</code> and <code>VSS</code>, while RMS-based EM analysis is performed on all nets inside the <code>X1</code> instance. The two-stage iterated method is used, and the current density limits for the EM report are referenced from file <code>.emfile.txt</code>. Only one subcircuit instance is allowed for EMIR analysis for a Spectre FX run. </p>
<p>
<a id="pgfId-1080614"></a><strong>Example EMIR control file (emir.config)</strong></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1080616"></a>net name=[X1.VDD X1.VSS] analysis=[vmax iavg] net name=[X1.*] analysis=[irms]</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1080617"></a>solver method=iterated</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1080618"></a>emirutil techfile=&quot;./emfile.txt&quot;</pre>

<p>
<a id="pgfId-1080619"></a>The EMIR control file supports the Spectre line continuation character + and comment-line characters * and //.</p>
<p>
<a id="pgfId-1080620"></a>The following table summarizes the supported EMIR control file options:</p>
<p>
<a id="pgfId-1080621"></a>The following table summarizes the supported EMIR control file options:</p>

<p>
<a id="pgfId-1081737"></a></p>
<table class="webflareTable" id="#id1080622">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080624"></a><strong>Keyword</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080626"></a><strong>Option Set</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080628"></a><strong>Explanation</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080630"></a><strong>Default Value</strong></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1080632"></a><strong>net</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080634"></a><code>name=[instance1.net1 instance1.net2....]</code></p>
<p>
<a id="pgfId-1080636"></a><code></code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080638"></a>Defines the nets for which the analysis is performed. <code>instance</code> defines the instance of the subcircuit containing the net. <code>net</code> defines the net name inside the subcircuit instance as it is defined in the <code>DSPF *| NET</code> definition. If the DSPF file is included at the top level, the instance name is not required. Wildcards aresupported for net names but not instance names.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080640"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080644"></a><code>analysis=[imax iavg iavgpos iavgneg iavgabs irms vmax vavg]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080646"></a><code>peakEM</code>, <code>avgEM</code>, <code>avgEM</code> for i&gt;0, <code>avgEM</code> for i&lt;0, <code>avgabsEM</code>, <code>rmsEM</code>, <code>peakIR</code>, <code>avgIR</code>. <code>imax</code>, <code>iavg</code>, <code>iavgabs</code>, <code>irms</code>, and <code>vmax</code> data are always written to the binary database independent of user settings.</p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1080647"></a>If <em>Voltus-Fi </em><code>acpeak</code> analysis is required, then <code>imax</code> and <code>irms</code> analyses need to be enabled in Spectre FX EMIR.</div>
<p>
<a id="pgfId-1080648"></a><code>imax</code> means <code>max(abs(current waveform))</code></p>

</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080650"></a><code>iavg, vmax</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080660"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080662"></a><code>pwrgate=[I1.VDD I1.VDD_INT...]global=[I1.VDD]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080666"></a>Enables power gate handling. You need to specify the power supply net driving the power gate (vsource connected) and the internal power supply net driven by the powergate. If one power supply net drives multiple power gates, you need to specify one statement with all internal power supply nets. If none of the powergate nets is driven by vsource, then the <code>global</code> statement can be used to define the global net.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080668"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080678"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080680"></a><code>analysis=[sigvmax sigvavg] reftype=[avg max min pin]<br />[findsrc=yes|no][refnode=name][vref=value]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080682"></a><code>analysis=sigvmax</code> - max signal net IR drop.</p>
<p>
<a id="pgfId-1080683"></a><code>analysis=sigvavg</code> - avg signal net IR drop.</p>
<p>
<a id="pgfId-1080684"></a><code>reftype=avg</code> - reference voltage for IR drop is the average voltage of all subnodes at every time point. This is the default.</p>
<p>
<a id="pgfId-1080685"></a><code>reftype=max</code> - reference voltage for IR drop is the maximum voltage of all subnodes at every time point.</p>
<p>
<a id="pgfId-1080686"></a><code>reftype=min</code> - reference voltage for IR drop is the minimum voltage of all subnodes at every time point.</p>
<p>
<a id="pgfId-1080687"></a><code>reftype=pin findsrc=yes</code> - Reference voltage of IR drop is taken from vsource, which is traced back from <code>*P|</code> node.</p>
<p>
<a id="pgfId-1080688"></a><code>reftype=pin</code> <code>findsrc=no</code> - Reference voltage of IR drop is taken from <code>*P|</code> node.</p>
<p>
<a id="pgfId-1080689"></a><code>refnode</code> - use the reference voltage from the specified reference node.</p>
<p>
<a id="pgfId-1080690"></a><code>vref</code> - use the voltage value as reference and report the value as vmax and not as sigvmax in the report.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080692"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080726"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1084090"></a><code>name [instance.net1...]<br />r2r_refnet=VSS<br />analysis=[r2rvmin]<br />[r2rvmin_layer=mt1]r2rvm<br />in_refnet_layer=[m2]<br />r2rvmin_tap_inst=[MN1*<br />MN2*]<br />r2rvmin_refnet_tap_inst=<br />[MN3* MN4*]<br />r2rvmin_model=[pch_...]<br />r2rvmin_refnet_model=[nc<br />h_...] r2rvmin_bbox=[1.0<br />1.0 269.5 279.5]<br />r2rvmin_refnet_bbox=[...]<br />r2rvmin_node_report=[on|<br />off]<br />r2rvmin_rule_name=name<br />r2rvmin_excl_layer=[m6]<br />r2rvmin_refnet_excl_laye<br />r=[m9]<br />r2rvmin_excl_tap_inst=[M<br />N5]<br />r2rvmin_refnet_excl_tap_<br />inst=[MN6] r2rvmin_excl_model=[pch.<br />..]<br />r2rvmin_refnet_excl_mode l=[pch...] r2rvmin_excl_bbox=[32.99<br />95.92 41.01 99.659]<br />r2rvmin_refnet_excl_bbox<br />=[...]<br /></code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1084223"></a>Worst case differential (rail-to-rail) IR drop between thespecified power supply node and the reference net written to the <code>*.rpt.r2r </code>file. If r2r_refnet is not specified, the ground node is automatically detected. At each time point, the sub node with the highest IR drop is selected for power and ground net and the differential voltage is calculated. The worst case differential IR drop over the EMIR time window is reported and the worst case power and ground waveforms are written to the waveform file. Optional scoping (combined with AND) includes layer names, tap device names, and tap device model names for both power supply node and refnet. A boundary box can be defined for power supply net and refnet. </p>
<p>
<a id="pgfId-1084351"></a>Optionally, a name can be assigned to each <code>r2rvmin</code> option. <code>r2rvmin_node_report</code> enables additional report of nodes and XY coordinates (default is off). Exclude statements supported for layers, tap device instances, models, and bounding boxes. All exclude statements allow you to specify file content. For example,<br /><code>r2rvmin_refnet_excl_tap<br />_inst_file=refexcl.txt</code>.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080735"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080746"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080748"></a><code>vref=value</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080750"></a>Defines the optional voltage reference value for <code>vmax</code> and <code>vavg</code> analyses.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080752"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080762"></a><code></code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080764"></a><code>exclude=[netname1 netname2...]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080766"></a>Excludes the specified nets when <code>name=[*]</code> is used.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080768"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080770"></a><strong>solver</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080772"></a><code>method=[auto|direct|iterated|profonly|iteronly | iterated_split]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080774"></a><code>auto - </code>direct for Spectre FX and Spectre X<br />direct - forced direct method<br /><code>iterated - </code>forced iterated method<br /><code>profonly - </code>iterated flow - circuit profile generation<br /><code>iteronly - </code>iterated flow - RC network iteration (requires <code>solver inputwf=iterated.emirtap.pwl)<br />iterated_split</code> - iterated flow - Same as iterated; however, it runs the first and second stages as separate processes to reduce peak memory usage</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080776"></a><code>auto</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080882"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080885"></a>glo<a id="global_pwr_net"></a>bal_pwr_net=[name1 name2 &#8230;]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080887"></a>By default, IR drop is enabled ony for DSPF subcircuit ports that are driven by a DC vsource. If a subcircuit port is not connected to a DC vsource, it can be defined as a power supply node using the <code>global_pwr_net</code> option and IR drop on this net can be calculated by specifying the <code>analysis=vmax</code> statement on this net. The IR drop reference value used is the maximum value of the voltage waveform at the specified port. This feature is only supported in iterated method. Wildcarding is not allowed. Once enabled, the net can be used in the <code>pwrgate</code> statement.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080889"></a>none</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080910"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080912"></a><code>tstep=value</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080914"></a>Change the solver to a fixed timestep specified by <span class="webflare-courier-new" style="white-space:pre"><em>value</em></span>. The unit is in seconds.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080916"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080918"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080920"></a><code>min_tstep=value</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080922"></a>Minimum time step for adaptive time step. The unit is in seconds.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080924"></a><code>1ps</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080934"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080936"></a><code>rcsolve_multi_proc=[on|off]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080938"></a>If set to <code>on</code>, enables parallel (forked) processes for second stage network solving. You can use the <code>+mt</code> command-line option to specify the maximum number of cores to use. Small-sized nets (&lt; <code>rcsolve_1t_netsize</code>) are solved first with eight forked single-thread processes. Medium-sized nets are solved next with two forked four-thread processes. Large nets (&gt;<code>rcsolve_4t_netsize</code>) are solved with one main process using eight threads.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080940"></a><code>off</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080958"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080960"></a><code>ignore_tap=[name1 name2...]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080962"></a>Ignores the specified tap devices in dynamic, static EMIR, and SPGS. The specified tap devices are changed to subnodes and do not carry any current. In addition, they are not reported. It applies to only the second stage of the iterated method and is not supported in the direct method. Wildcards are supported.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080964"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080966"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080968"></a><code>report_tapc=[off|text]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080970"></a>Report the net and tap device capacitance values for nets being defined in the UTI command. The capacitance report is written to a file with extension <code>rpt_tapc</code>.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080972"></a><code>off</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080992"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080994"></a><code>inputwf=file_name</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080996"></a>Specifies the waveform file that contains the results from circuit simulation when <code>method=iteronly</code> is used.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1080998"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081000"></a>static</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081002"></a><code>ifile=</code><span class="webflare-courier-new" style="white-space:pre"><em>filename</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081004"></a>Enables static EMIR analysis. The filename defines the subcircuit instance port currents. Static EMIR analysis cannot be combined with dynamic EMIR analysis.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081006"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081008"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081010"></a><code>exclude=[net=[name1 name2] dev=[name1 name2]]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081012"></a>Exclude the tap devices from static current distribution. A 0A current is assigned to the specified tap devices. Wildcarding is supported for both <code>exclude</code> and <code>dev</code>. For example:</p>
<p>
<a id="pgfId-1081013"></a><code>exclude=[net=[I1.VDD] dev=[MPM3*]]</code>.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081015"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081057"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081059"></a><code>report_tapi=[true|false]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081061"></a>Enables the printing of individual tap device currents in static EMIR analysis. The current values are written to a file with the extension <code>rpt_tapi</code>.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081063"></a><code>false</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081065"></a><strong>emirutil</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081067"></a><code>techfile=&quot;emDataFile&quot; </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1081069"></a>Specifies the EM rule file in the emdatafile, qrctechfile, or ICT file format. </p>
<p>
<a id="pgfId-1081070"></a>The EM rule file can be predefined in the configuration file using the <code>EMTECHFILE</code> environment variable, as shown below.<br /><code>setenv EMTECHFILE=&quot;&lt;</code><span class="webflare-courier-new" style="white-space:pre"><em>path</em></span><code>&gt;/</code><span class="webflare-courier-new" style="white-space:pre"><em>emdatafile</em></span>&quot;</p>
<p>
<a id="pgfId-1081071"></a>It can also be defined in the <code>.cdsinit</code> file as follows:<br /><code>envSetVal(&quot;spectre.envOpts&quot; &quot;emTechFile&quot; string &lt;</code><span class="webflare-courier-new" style="white-space:pre"><em>path to the file</em></span><code>&gt;</code></p>

<p>
<a id="pgfId-1081072"></a>Case-insensitive layer names are supported for easier match between the DPSF file and emData file.</p>
<p>
<a id="pgfId-1081073"></a>The rule file defined in the configuration file has higher priority followed by the rule file specified in <code>.cdsinit</code>. The rule file specified using the environment variable has the least priority.</p>
<p>
<a id="pgfId-1081074"></a>Alternatively, you can use the <code>emdatafile=&quot;</code><span class="webflare-courier-new" style="white-space:pre"><em>emDataFile</em></span><code>&quot;</code> option to specify the techfile in the emdata format, <code>qrctechfile</code>=&quot;<span class="webflare-courier-new" style="white-space:pre"><em>qrcTechFile</em></span>&quot; to specify the QRC tech files, and <code>ictfile=&quot;ictfile&quot;</code> to specify the file in ICT format.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081076"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081078"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081080"></a><code>layermapfile=&quot;mapfile&quot;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1081082"></a>Optional file that defines the mapping between the layer names in the DSPF file and the layer names in the technology file. </p>

</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081084"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081086"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081088"></a><code>EMOnlyICTFile=&quot;emOnlyICTfile&quot;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1081090"></a>Specifies the file containing only the EM rules. It is usually used in combination with qrcTechFile.</p>

</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081092"></a><code>none</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081094"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081096"></a><code>autorun=[true|false]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081098"></a><code>true</code>: run <code>emirutil</code> automatically after the solver to generate a text report.</p>
<p>
<a id="pgfId-1081099"></a><code>false</code>: manually run <code>emirutil</code>.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081101"></a><code>true</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081103"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081105"></a><code>report=[text|layout | html]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081107"></a>Defines the type of report created by <code>emirutil</code>.</p>
<p>
<a id="pgfId-1081108"></a><code>text</code>: creates only the text report.</p>
<p>
<a id="pgfId-1081109"></a><code>layout</code>: creates only the layout violation map.</p>
<p>
<a id="pgfId-1081110"></a><code>html</code>: creates the report in html format.</p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1081111"></a>Multiple entries are supported.</div>

</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081113"></a><code>text</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081115"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081117"></a><code>notation=[s|e]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081119"></a>Notation for the text and html reports.</p>
<p>
<a id="pgfId-1081120"></a><code>e</code>: engineering scale number (for example, 5.02m)</p>
<p>
<a id="pgfId-1081121"></a><code>s</code>: scientific notation (for example, 5.02e-3)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081123"></a><code>e</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081125"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081127"></a><code>sort_by_net=yes|no</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081129"></a>Report IR and EM results per net, or all nets.</p>
<p>
<a id="pgfId-1081130"></a><code>yes</code>: report EMIR results per net.</p>
<p>
<a id="pgfId-1081131"></a><code>no</code>: combine EMIR results of all nets into one report.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081133"></a><code>yes</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081284"></a><strong>time</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081286"></a><code>window=[start1 stop1 start2 stop2 ...] </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081288"></a>Time window to which the EMIR analysis is applied. It applies to all nets for which the analysis is defined. Multiple and overlapping windows are supported. An individual report is created for each time window. You can use different time windows for emirutil v/s Spectre simulation.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081290"></a><code>[0 tend]</code></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1081738"></a>The EMIR control file supports the Spectre line continuation character <code>+</code>, and the comment lines start with character <code>*</code> or string <code>//</code>. </p>

<h4>
<a id="pgfId-1081739"></a>Checking the Progress of EMIR Analysis</h4>

<p>
<a id="pgfId-1081740"></a>As the simulation runs, Spectre FX sends messages to the screen and the simulation log file that show the progress of the simulation and provide statistical information. Following information may be significant to your EMIR analysis when you use the iterated method.</p>

<h4><em>
<a id="pgfId-1081741"></a>Hardware configuration and run-time machine loading</em></h4>

<p>
<a id="pgfId-1081742"></a>In the beginning of a simulation session, Spectre FX prints the hardware configuration (physical memory, CPU core specification) and the run-time machine status (available memory, CPU core operating frequency, CPU loading). Since EMIR analysis often involves large-scale designs with gigabytes of data, it is important to ensure that there is sufficient memory available, with CPU operating at full speed (not in power saving mode), and the machine loading is light.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081743"></a>User: user1 Host: lnx-user1 HostID: CD0A1190&#160;&#160; PID: 26141</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081744"></a>Memory&#160;&#160;available: 10.2268 GB&#160;&#160;physical: 16.6236 GB</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081745"></a>CPU Type:&#160;&#160;      Intel(R) Xeon(R) CPU E5-1650 0 @ 3.20GHz</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081746"></a>          Processor PhysicalID CoreID Frequency Load</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081747"></a>              0         0        0     3192.5     0.3</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081748"></a>              1         0        1     3192.5     0.2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081749"></a>              2         0        2     3192.5     0.3</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081750"></a>              &#8230;</pre>
<h4><em>
<a id="pgfId-1081751"></a>Reading the EMIR Control File</em></h4>

<p>
<a id="pgfId-1081752"></a>Spectre FX reads the EMIR control file before processing the circuit being simulated. All valid EMIR options are reported in the following section:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084487"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />EMIR Analysis Configuration<br />~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />
nets&#160;&#160;          name=[i1.VDD i1.VSS] analysis=[vmax iavg]<br />nets            name=[i1.*] analysis=[irms]<br />solver          method=iterated<br />emirutil&#160;&#160;      techfile = emDataFile.txt</pre>

<p>
<a id="pgfId-1081764"></a>If one of the specified EMIR options is not displayed in the summary, check the related warnings, and correct the syntax.</p>

<h4><em>
<a id="pgfId-1081775"></a>Running the Circuit Simulation to Produce Voltage Profiles</em></h4>

<p>
<a id="pgfId-1081776"></a>At this point, with the simplification of power and signal nets, Spectre FX is ready to simulate the nonlinear circuit and produce voltage profiles needed for iterated EMIR analyses. This step is similar to a regular circuit simulation, where Spectre FX first parses the circuit, reports circuit inventory, initiates a DC analysis, and finishes the step with a transient analysis.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081777"></a>Creating probes for EMIR analysis: 57 voltage probes, 0 current probes<br />
Time for setting up EMIR tap devices: CPU = 0 s (0h 0m 0s), elapsed = 0 s (0h 0m 0s).</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084539"></a>
Time for setting up EMIR analysis: CPU = 580.0 ms (0h 0m 0s), elapsed = 80.0 ms (0h 0m 0s).
&#8230;
****************************************************** 
Transient Analysis `transient1&#39;: time = (0 s -&gt; 20 ns)
******************************************************
&#8230;
......9......8......7......6......5......4......3......2......1.&#160;&#160;&#160;&#160;0
Number of accepted tran steps =&#160;&#160;&#160;&#160;918<br />Total time required for tran analysis `tran&#39;: CPU = 4.88835 s, <br />elapsed = 625.093 ms, util. = 782%.<br />
Time accumulated: CPU = 7.64419 s, elapsed = 5.33127 s.
Peak resident memory used = 158 Mbytes.
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081798"></a>Time for creating waveform database: CPU = 10.0 ms (0h 0m 0s), elapsed = 10.0 ms (0h 0m 0s).</pre>

<p>
<a id="pgfId-1081799"></a>The reported transient time and the accumulated time are important measures to be considered when optimizing performance. The voltage profiles of the tap devices (active devices connecting to the power and signal RC nets) are stored in the pwl files, and used as input for the second stage EMIR simulation.</p>
<p>
<a id="pgfId-1081800"></a>This step of EMIR simulation is fully multi-threaded. It uses the number of cores defined by the <code>+mt</code> command-line option.</p>

<h4><em>
<a id="pgfId-1081801"></a>Simulating the Parasitic RC Nets</em></h4>

<p>
<a id="pgfId-1081802"></a>In the second stage of the iterated EMIR analysis, the power and signal nets are simulated together with the tap devices. During the simulation, the tap device terminal voltages over time is taken from the voltage profiles created in the first stage. In the second stage, nets are solved individually, except for coupled nets, which are solved together. </p>
<p>
<a id="pgfId-1081803"></a>The RC network solver writes all IR drop voltage and EM current values to the binary database with the extension <code>emir0_bin</code>. Important log file content is written to the <code>EMIR PARASITICS ANNOTATION SUMMARY</code> section, which provides information on the nets and R/C elements processed. In addition, the number of solved time steps per net, and the elapsed time for the RC solving are essential when optimizing performance.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081804"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084597"></a>*****************<br />Start EMIR RC Analysis at Sat May  6 00:37:07 2023<br />*****************<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084601"></a>Current resident memory used = 153.27 Mbytes.<br />

Reading EMIR configuration file:&#160;&#160;input.raw/input.emirtap.conf<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084606"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />EMIR Analysis Configuration<br />~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />solver          method = iteronly<br />solver          inputwf = input.raw/input.emirtap/input.emirtap.pwl<br />
Current resident memory used = 153.34 Mbytes, Peak memory used = 153.34 Mbytes, at Sat May&#160;&#160;6 00:37:07 2023<br />emir 2nd stage solver pre_sim time is set to 0n<br />Time for Pre process           : CPU = 0 s (0h 0m 0s), elapsed = 0 s (0h 0m 0s).<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084616"></a>&#8230;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084617"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084618"></a>Maximum grounded vsource value = 2.5v<br />&#8230;<br />
Searching and processing cross coupling capacitors in SPF file
./adc_sample_hold.dspf
Sat May&#160;&#160;6 00:37:07 2023<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084625"></a>Cross coupling capacitors found and processed: 0<br />
EMIR RC analysis cross coupling capacitor parsing elapsed time: 0.020 s.
&#8230;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084629"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />EMIR PARASITICS ANNOTATION SUMMARY<br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084633"></a>Nets:                      parsed            18 processed            18<br />Cross coupling capacitors: parsed             0 processed             0<br />Capacitors:                parsed          3709 processed          3709<br />Resistors:                 parsed          6803 processed          6712<br />Nodes:                     parsed          5955 processed          5955<br />
Nets annotated with C-only:&#160;&#160;      0  Nets annotated with RC:       18<br />No errors and No warnings(fixed errors)<br />

Postprocessing 2nd stage waveform files Sat May&#160;&#160;6 00:37:09 2023<br />Done at Sat May  6 00:37:09 2023<br />
&#8230;
</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084648"></a>~~~~~~~~~~~~~~~~~<br />EMIR NET COVERAGE<br />~~~~~~~~~~~~~~~~~<br />Number of non-emir nets = 0<br />Number of emir nets     = 18<br />          Number of skipped nets             = 0<br />          Number of successfully solved nets = 18<br />          Number of failed nets              = 0<br />Number of accepted time steps = 4570 (average 253.889 per net)<br />Number of total time steps = 4570<br />Number of rejected time steps = 0 (average 0 per net)<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084660"></a>average number of Newton Iterations per dc/tran solve = 0.0784656<br />average number of solver iterations = 3.3846<br />EMIR PERFORMANCE INFO:<br />          Net                Elapsed Time         Time Steps<br />          i1.sample          0.26s                813<br />          i1.hold            0.25s                780<br />          i1.Vcm             0.24s                685<br />          i1.Vcp             0.24s                685<br />          i1.inp             0.18s                559<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084670"></a>Finished EMIR RC Analysis at Sat May&#160;&#160;6 00:37:09 2023</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084671"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084672"></a>Total time required for EMIR RC analysis: CPU = 4.1&#160;&#160;s (0h 0m 4s), elapsed = 1.6&#160;&#160;s (0h 0m 1s).</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084673"></a>Peak resident memory used = 158.2 Mbytes</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081866"></a></pre>

<p>
<a id="pgfId-1081867"></a>This step of the EMIR simulation is fully multi-threaded. It uses the number of cores defined by the <code>+mt</code> command-line option.</p>
<p>
<a id="pgfId-1081868"></a>After the EMIR data is available in the binary database, another step is performed to create the text reports for IR drop, EM currents, pin currents, and power gate information. The following output shows the related section in the log file (some content is only written to stdout):</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084914"></a>Creating EMIR report, check &#39;input.raw/input.emirtap.emirlog&#39; for more information.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084915"></a>Pre process           : CPU = 0 s (0h 0m 0s), elapsed = 0 s (0h 0m 0s)<br />Database building     : CPU = 120.0 ms (0h 0m 0s), elapsed = 150.0 ms (0h 0m 0s)<br />Simulating nets       : CPU = 4.0  s (0h 0m 4s), elapsed = 1.4  s (0h 0m 1s)<br />Circuit update      : CPU = 290.0 ms (0h 0m 0s), elapsed = 130.0 ms (0h 0m 0s)<br />RC solver           : CPU = 2.1  s (0h 0m 2s), elapsed = 860.0 ms (0h 0m 0s)<br />Time step prediction: CPU = 300.0 ms (0h 0m 0s), elapsed = 170.0 ms (0h 0m 0s)<br />Device evaluation   : CPU = 820.0 ms (0h 0m 0s), elapsed = 180.0 ms (0h 0m 0s)<br />Output              : CPU = 470.0 ms (0h 0m 0s), elapsed = 130.0 ms (0h 0m 0s)<br />Instance section      : CPU = 0 s (0h 0m 0s), elapsed = 10.0 ms (0h 0m 0s)<br />Post process          : CPU = 0 s (0h 0m 0s), elapsed = 0 s (0h 0m 0s)<br />Generate text report&#160;&#160;: CPU = 120.0 ms (0h 0m 0s), elapsed = 140.0 ms (0h 0m 0s) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081893"></a></pre>

<p>
<a id="pgfId-1081894"></a>At the end of the simulation, Spectre FX reports the total simulation time and peak memory used.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1084966"></a>Aggregate audit (3:53:45 AM, Tue Jan 12, 2016):<br />Time used: CPU = 2.38 s, elapsed = 63.3 s (1m 3.3s), util. = 3.76%.<br />Time spent in licensing: elapsed = 60.1 s (1m 0.1s), percentage of total = 94.8%. Peak memory used = 68.8 Mbytes.</pre>
<h4>
<a id="pgfId-1081900"></a><a id="18315"></a>Viewing EMIR Results</h4>

<p>
<a id="pgfId-1081901"></a>Spectre FX EMIR writes the IR voltage and EM current values to a binary database with the extension <code>emir0_bin</code>. In addition, it automatically calls the <code>emirreport</code> or <code>emirutil</code> binary for creating the text or html reports. </p>
<p>
<a id="pgfId-1081902"></a>The textual/html IR drop report (file extension: <code>rpt_ir/rpt_ir.html</code>) lists the voltage drop per net (in the order of largest to smallest), and provides information about the time the maximum IR drop occurred, as well as the layer information and layer coordinates. An example section of an IR drop report is shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1085021"></a>
VOLTAGE DROP RESULTS

&#8230;

-------------------- &quot;VDD&quot; NET: Vref = 2.5V -----------------------------------
max - drop

VOLTAGE-DROP&#160;&#160;  NETNAME         TIME            LAYER            X               Y<br />(V)                           (s)                             (um)            (um)<br />6.212m          MPM1@16:s       20.781p         mwires          75.120          76.080<br />6.212m          MPM3@9:s        20.781p         cont            75.120          76.080<br />6.211m          VDD:567         20.781p         metal1          75.120          95.840<br />
</pre>

<p>
<a id="pgfId-1085088"></a>The EM report (file extension: <code>rpt_em/rpt_em.html</code>) lists the pass/fail results for each resistor segment of a net, and provides information about the resistor name, layer, current, layer width, density (current divided by width), density limit, number of vias required, and the coordinates.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1085098"></a>ELECTROMIGRATION ANALYSIS RESULTS<br />
&#8230;

----------------------- NET &quot;VDD&quot; -------------------------------
avg

There is no resistor whose current density exceeds the limit.

%failed&#160;&#160;    resistor layer   current  width    pathLength density      limit needed width/#vias  X1      Y1      X2      Y2     resistance<br />(A)    (um)     (um)       (A/um)       (A/um)       (um/#)             (um)    (um)    (um)    (um)    (ohm)<br />pass-16.05%  rr1027   via2    1.504m   4.480    155.735    335.783u     400.000u     14(16)             60.190  206.060 60.190  206.060 0.0875<br />pass-30.86%  rr1026   via2    309.737u 1.120    155.735    276.551u     400.000u     3(4)               60.200  199.280 60.200  199.280 0.350<br />pass-36.10%&#160;&#160;rr1019&#160;&#160; via2&#160;&#160;  1.145m   4.480    155.735    255.598u     400.000u     11(16) </pre>

<p>
<a id="pgfId-1081934"></a>The EMIR text and html reports can also be created using an existing EMIR binary database using the following command:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1081935"></a>$ emirutil -db input.emir0_bin -control emir.conf</pre>

<p>
<a id="pgfId-1081936"></a>For more information on <code>emirutil</code>/<code>vpsbatch</code> utility for creating the reports, and for the visualization of the EMIR analysis results in the layout, refer to the <em>Voltus-Fi </em>user manual. </p>
<p>
<a id="pgfId-1081937"></a>If there are multiple <code>emir0_bin</code> files created by the same Spectre FX EMIR simulation, it is sufficient to specify only the first binary database file with the <code>-db</code> option. The utility automatically identifies all other binary database files created by the Spectre FX EMIR simulation.</p>

<h4>
<a id="pgfId-1081938"></a>Data Flow</h4>

<p>
<a id="pgfId-1081939"></a>The data flow of the iterated EMIR flow is shown in the following flowchart. The first stage EMIR circuit simulation creates the tap device voltage profiles which are stored in the pwl files, and used in the second stage. The second stage RC network solver writes all IR drop and EM current values to a binary database with the extension <code>emir0_bin</code>. This binary database is used by <code>emirutil</code>/<code>emirreport</code> for creating the text/html reports, and by <em>Voltus-Fi XL</em> to visualize the results in the layout.</p>
<p>
<a id="pgfId-1085195"></a></p>

<div class="webflare-div-image">
<img width="668" height="404" src="images/postlayout-6.gif" /></div>
<p>
<a id="pgfId-1085210"></a></p>

<p>
<a id="pgfId-1082002"></a>All intermediate and output files are written into the Spectre FX output (raw) directory. Some files shown in the figure are only created when the related feature is enabled in the EMIR config file.</p>
<p>
<a id="pgfId-1082003"></a>If multiple EMIR windows are used in the same EMIR simulation, a set of files is created for each EMIR time window. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082005"></a>Time window 1: emir0_bin, rpt_ir, rpt_em, &#8230; <br />Time window 2: emir1_bin, rpt_ir1, rpt_em1, &#8230;</pre>

<p>
<a id="pgfId-1082006"></a>The data flow for the direct EMIR method is the same except that the intermediate files are not created. Only the iterated method EMIR files have the <code>emirtap</code> file extension.</p>
<p>
<a id="pgfId-1082007"></a>Direct method: <code>design.emir0_bin</code>, <code>design.rpt_ir</code>, <code>design.rpt_em</code></p>
<p>
<a id="pgfId-1082008"></a>Iterated method: <code>design.emirtap.emir0_bin</code>, <code>design.emirtap.rpt_ir</code>, <code>design.emirtap.rpt_em</code></p>
<p>
<a id="pgfId-1082009"></a>For large designs, the intermediate (<code>pwl</code>, <code>pdb</code>) and EMIR database files (<code>emir0_bin</code>) can be compressed by using the <code>eisopt zipfiles=2</code> option in the EMIR config file.</p>

<h3>
<a id="pgfId-1082458"></a><a id="73763"></a>Power Gate Support</h3>

<p>
<a id="pgfId-1082459"></a>Power networks may contain power gates (four-terminal MOSFET device) which enable or disable the power supply in the circuit. These power gates split the power supply RC network into two parts; the RC network driving the power gate, and the RC network being driven by the power gate. These nets are strongly coupled together and they should be simulated together in EMIR analysis.</p>

<p>
<a id="pgfId-1082463"></a></p>
<div class="webflare-div-image">
<img width="668" height="319" src="images/postlayout-7.gif" /></div>

<p>
<a id="pgfId-1082464"></a>To invoke power gating handling, add the power gate setting in the EMIR control file (<code>emir.config</code>), as shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082465"></a>net pwrgate=[vdd vdd_int] analysis=[vmax]</pre>

<p>
<a id="pgfId-1082466"></a>Both, the global power supply net <code>vdd</code> driving the power gates, and the virtual internal power supply net <code>vdd_int</code> driven by the power gates, need to be specified in the <code>net</code> statement in any order. Wildcards are supported for internal power supply nets, but not for power supply nets. If one power supply net drives multiple power gates, one statement with all power supply nets needs to be defined, as shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082467"></a>net pwrgate=[vdd vdd_int1 vdd_int2] analysis=[vmax]</pre>

<p>
<a id="pgfId-1082468"></a>The IR drop report includes both the power supply net in the usual report file name, for example, <code>input.rpt_ir</code> and the internal power supply net is reported in a file, such as <code>input.rpt_pwg</code> or <code>input.emirtap.rpt_pwg</code> for direct and iterated methods respectively. The IR drop for the virtual power net includes the voltage drop on the global power net, the voltage over the power gate, and the voltage drop on the virtual power net. EM analysis is performed as usual, if specified. </p>
<p>
<a id="pgfId-1082469"></a>In addition, an important parameter <code>Ton</code> is also reported in the <code>.rpt_pwg</code> file. It reports the time taken to power-up the terminal of the internal power supply net to 95% of the power supply level (VDD). </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1082470"></a>The parameter <code>Ton</code> can be infinity if the internal power supply level does not reach 95% of VDD. </div>
<p>
<a id="pgfId-1082471"></a>Each <code>pwrgate</code> statement allows you to define only one global power node and the related virtual power nodes. If a design contains multiple global nodes with power gates and virtual nodes, then, for each of them, a separate <code>pwrgate</code> statement is required.</p>
<p>
<a id="pgfId-1082472"></a>Serial power gate structures are supported. For such gate structures, not only the top-level power supply net and the internal supply net, but also the net between the serial power gates needs to be specified.</p>

<h3>
<a id="pgfId-1082476"></a><a id="42145"></a>Handling the Complexity of DSPF/SPEF files</h3>
<h4>
<a id="pgfId-1082478"></a><a id="61556"></a>SPF Checker</h4>

<p>
<a id="pgfId-1082479"></a>The DSPF files are created with parasitic extraction tools like QRC. The content and format of a DSPF file is heavily dependent on the extraction tool and the settings. Often, simulation problems occur due to problems in the DSPF file.</p>
<p>
<a id="pgfId-1082480"></a>SPF Checker is a utility that analyses a DSPF file, reports problems which may cause simulation problems, and creates an EMIR configuration file with the recommended mapping statements for EMIR analysis. </p>
<p>
<a id="pgfId-1085323"></a>The SPF checker utility can be located at &lt;spectre_install_dir<a id="OLE_LINK12"></a>&gt;/tools.&lt;plat&gt;/bin/ spfchecker.</p>
<p>
<a id="pgfId-1085300"></a>The SPF checker utility can be run as follows::</p>

<a id="pgfId-1082482"></a><pre class="webflare-courier-new webflare-syx-syntax codeContent">
spfchecker SPF_FILE_NAME[-<strong>d</strong>etail &lt;value&gt;] [-<strong>m</strong>essage &lt;value&gt;] [-<strong>l</strong>og <code><em>LOG_FILE_NAME</em></code>] &#8211;c EMIR_CONF_NAME] [-ckt=subckt_name] [-ctl=<code><em>filename</em></code>] [+lorder licenseList] -force &#8211;<strong>h</strong>elp</pre>
<p>
<a id="pgfId-1082552"></a></p>
<table class="webflareTable" id="#id1082483">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1082485">
<a id="pgfId-1082485"></a>Argument</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1082487">
<a id="pgfId-1082487"></a>Description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082489"></a><code>-dspf</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082491"></a>If the input is in DSPF format (default).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082493"></a><code>-spef</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082495"></a>If the input is in SPEF format.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082497"></a><code>-outdir &lt;dir_name&gt;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082499"></a>Set the output directory for the checker results. Default is <code>.</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082501"></a><code>-detail</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082503"></a>Report detailed information (statistics) for NETs whose subnodes are more than the value specified using <code>-d</code>. Default is 0.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082505"></a><code>-message</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082507"></a>Set the maximum number of messages for each type of error. Default is 50.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082509"></a><code>-log name</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082511"></a>Set the checker log file name. If this argument is not specified, a file with the name<code> SPF_FILE_NAME.chklog</code> is created by default.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082513"></a><code>-c name</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082515"></a>Create the EMIR configuration file. If this argument is not specified, a file with the name <code>SPF_FILE_NAME.emir_conf</code> is created by default.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082517"></a><code>-opt name</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082519"></a>Create a backannotation option file. If this argument is not specified, a file with the name <code>SPF_FILE_NAME.stitch_opt </code>is created by default.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082521"></a><code>-ckt subckt</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082523"></a>Define the subcircuit scope. Default is the first subcircuit definition found.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082525"></a><code>+lorder</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082527"></a>Specify the license checkout order. The default checkout order is <code>PRODUCT:MMSIM</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082529"></a><code>-fix name</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082531"></a>Fix the common connection errors and create a new DSPF file.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082533"></a><code>-dump_cc name</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082535"></a>Dump the cross coupling capacitors into the named file</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082537"></a><code>-dump_lvl level</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082539"></a>Set the level to dump the original coupling capacitors. Default is 0.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082541"></a><code>-force</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082543"></a>Overwrite the previous SPF checker results.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082545"></a><code>-ctl file</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082547"></a>Exclude the parasitic resistors specified in the list. For example, ctl file: spf_ignore_layers = [M1 M2]</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082549"></a><code>-help</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1082551"></a>Display help related to the SPF Checker utility.</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1082553"></a>The SPF checker creates the following files:</p>
<ul><li>
<a id="pgfId-1082554"></a><code>test.spf.chklog</code> - Detailed SPF checker log file</li><li>
<a id="pgfId-1082555"></a><code>test.spf.spfinfo</code> - DSPF element inventory</li><li>
<a id="pgfId-1082556"></a><code>test.spf.emir_conf</code> - Recommended settings for EMIR config file</li><li>
<a id="pgfId-1082557"></a><code>test.spf.stitch_opts</code> - Recommended (SPICE format) settings for DSPF backannotation</li></ul>



<p>
<a id="pgfId-1082558"></a>Before running any EMIR analyses, ensure that your DSPF file is clean. This can be achieved by running the <code>spfchecker</code> utility and by confirming that <code>spfchecker</code> does not report an error message in the <code>*chklog</code> file. Typical error messages in the <code>chklog</code> file are:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082559"></a>SPF-0003:&#160;&#160;  2           ERROR: NETs broken into pieces</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082560"></a>SPF-0016:&#160;&#160;  6           ERROR:Instances with different connection from                                          the NET Section</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082561"></a>SPF-0019:&#160;&#160;  430         ERROR: NETs with sub-nodes not connecting to any                                          parasitics</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082562"></a>SPF-0028:&#160;&#160;   1           ERROR: Instance model terminal definition conflicts</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082563"></a>SPF-0039:&#160;&#160;   3854807     ERROR: Layer is extracted as both via and metal layer</pre>

<p>
<a id="pgfId-1082564"></a>Simulating a DSPF file for which <code>spfchecker</code> reported errors may generate invalid EMIR simulation results. If <code>spfchecker</code> reports warnings and no errors, the DSPF file can be used in EMIR analysis.</p>
<p>
<a id="pgfId-1082565"></a>Additionally, <code>spfchecker</code> prepares content for the EMIR config file into the <code>*.emir_conf</code> file. This content can either manually be copied into the EMIR config file, or included with an <code>include</code> statement:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082566"></a>include test.spf.emir_conf</pre>
<h4>
<a id="pgfId-1082574"></a><a id="14785"></a>Port Order Handling</h4>

<p>
<a id="pgfId-1085427"></a>When setting up the EMIR simulation, you need to ensure that the subcircuit port order in the DSPF file matches the port order of the instance call in the top-level netlist. The .dspf_include command provides advanced functionality for port order mapping, as given below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1085412"></a>.dpsf_include file.spf port_order=[spf|sch] </pre>

<ul><li>
<a id="pgfId-1085451"></a><code>port_order=sch</code> : (Default). The port order is taken from schematic subcircuit definition. The same port number and names are required. If the schematic subcircuit definition is not available, a war:ning is issued in the log file, and DSPF port order is used.</li><li>
<a id="pgfId-1085459"></a>p<code>ort_order=spf</code>: The port order is taken from the DSPF subcircuit definition.</li></ul>


<h3>
<a id="pgfId-1082654"></a><a id="71161"></a>Advanced Analyses</h3>
<h4>
<a id="pgfId-1082679"></a>Signal Net IR Drop Analysis</h4>

<p>
<a id="pgfId-1085547"></a>IR drop analysis (analysis=[vmax vavg]) is typically applied to power nets that are driven by voltage sources, which provides a constant reference voltage over the EMIR window. However, designs may have internal generators or regulators. For the generator driven nets, an IR drop analysis may be important. These nets behave like signal nets since their voltage value changes over time.</p>
<p>
<a id="pgfId-1085549"></a>The Spectre FX EMIR signal net IR drop analysis (analysis=[sigvmax sigvavg]) allows you to perform IR drop analysis on such nets. However, you need to define the reference voltage being used for the IR drop calculation. The recommended setting for generators is refnode=vdd. At each time point, it calculates the voltage at the reference node vdd, and calculates the IR drop in reference to this voltage.</p>
<p>
<a id="pgfId-1082684"></a></p>

<div class="webflare-div-image">
<img width="668" height="364" src="images/postlayout-8.gif" /></div>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082685"></a>net name=[i1.vdd] analysis=[sigvmax] refnode=vdd</pre>

<p>
<a id="pgfId-1082686"></a>The following are supported for defining the reference voltage:</p>
<ul><li>
<a id="pgfId-1082687"></a><code>reftype=max</code> - Use the maximum voltage of all nodes at each time point.</li><li>
<a id="pgfId-1082688"></a><code>reftype=avg</code> - Use the average voltage over all nodes at each time point (default).</li><li>
<a id="pgfId-1082689"></a><code>reftype=pin</code> <code>findsrc=true</code> - For the given nets, use the vsource connected to <code>*|P</code> node.</li><li>
<a id="pgfId-1082690"></a><code>reftype=pin</code> <code>findsrc=false</code> - For the given nets, use the <code>*|P</code> node as the reference, and not vsource.</li><li>
<a id="pgfId-1082691"></a><code>refnode=</code><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> - Use the specified sub node of <code>*|NET</code> as reference.</li><li>
<a id="pgfId-1082692"></a><code>vref=</code><span class="webflare-courier-new" style="white-space:pre"><em>value</em></span> - Use the specified voltage as reference.</li></ul>





<p>
<a id="pgfId-1082693"></a>When using <code>reftype=max</code> for a net with three subnodes: <code>net1:1 (1V)</code>, <code>net1:2 (2V)</code>, and <code>net1:3 (3V)</code>, the detected reference voltage will be 3V, and the IR drop calculated will be 2V for <code>net1:1</code>, 1V for <code>net1:2</code>, and 0V for <code>net1:3</code>. When using <code>reftype=avg</code> the reference voltage will be 2V, and the IR drop calculated will be 1V for <code>net1:1</code>, 0V for <code>net1:2</code>, and -1V for <code>net1:3</code>. </p>
<p>
<a id="pgfId-1082694"></a>The signal net IR drop analysis is automatically changed to a regular IR drop analysis (<code>vmax</code>), if <code>vref=value</code> is specified, or if the net (during the EMIR time window) is driven by a constant voltage source.</p>

<h4>
<a id="pgfId-1082714"></a>Differential (Rail-to-Rail) IR Drop An<a id="differential_irdrop"></a>alysis</h4>

<p>
<a id="pgfId-1082715"></a>The differential IR drop feature allows you to identify the worst-case IR drop between the specified power supply and the ground node. At each time point, it calculates the worst IR drop over all the power supply sub nodes, and the worst IR drop over all the ground sub nodes. At each time point, it also calculates and reports the worst case rail-to-rail voltage for the given EMIR time window.</p>

<p>
<a id="pgfId-1082719"></a></p>
<div class="webflare-div-image">
<img width="668" height="298" src="images/postlayout-9.gif" /></div>

<p>
<a id="pgfId-1082720"></a>The differential IR drop analysis is enabled with the <code>analysis=r2rvmin</code> option. Multiple power supply nodes can be specified. If the ground node is not specified in the <code>r2r_refnet</code> statement, Spectre FX automatically detects the global ground node.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082721"></a>net name=[VDD] r2r_refnet=VSS analysis=[r2rvmin] </pre>

<p>
<a id="pgfId-1082722"></a>The following is an example of a differential IR drop report:</p>
<p>
<a id="pgfId-1085356"></a></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1085341"></a>**r2rvmin RESULT</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1085342"></a>Power_net_name R2rvmin_value  R2rvmin@time   Attribute      Ref_net_name   Ideal_r2rvmin  Ref_Attribute  Rule_name<br />               (V)                                                         (V)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1085344"></a>VDD&#160;&#160;          2.489          20.781p        0              VSS            2.500          1              _R2RVMIN_AUTO_RULE_1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082726"></a></pre>

<p>
<a id="pgfId-1082727"></a>The <code>r2rvmin</code> feature allows you to apply the analysis only to selected layers, selected tap devices, tap devices of a user-defined model, and selected bounding boxes. Combinations are supported and combined with the AND behavior. Excluding tap nodes based on their layer, model, or instance information is also supported. To differentiate between multiple <code>r2rvmin</code> reports, you can apply the rule names to each <code>r2rvmin</code> statement (<code>r2rvmin_rule_name</code>). Refer to the <code>r2rvmin</code> option in the table under the <a href="postlayout.html#22246">EMIR Control File</a> section for more information. The differential (rail-to-rail) IR drop analysis is only supported in the direct method.</p>

<h4>
<a id="pgfId-1082733"></a><a id="80850"></a>Static EMIR A<a id="static_emir"></a>nalysis</h4>

<p>
<a id="pgfId-1082734"></a>Static EMIR analysis enables you to evaluate IR drop and EM currents based on the specified current consumptions for subcircuit instances without running a transient or DC simulation. The specified currents are distributed to the tap devices based on the width and length ratios of devices in the design. The IR drop and EM current analysis is performed based on the current at each tap device.</p>
<p>
<a id="pgfId-1082735"></a>To enable static EMIR analysis, you need to use the <code>static</code> <code>ifile</code> option in the EMIR configuration file, as shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082736"></a><code>net name=[I1.VDD I1.VSS] analysis=[vavg iavg]<br />static ifile=&quot;static_currents.txt&quot; </code></pre>

<p>
<a id="pgfId-1082737"></a>For static EMIR analysis, <code>vmax</code> and <code>vavg</code> for IR drop and <code>imax</code>, <code>irms</code>, and <code>iavg</code> values for EM currents remain the same, and therefore, just one can be selected in the statement.</p>
<p>
<a id="pgfId-1082738"></a>The subcircuit instance currents are defined (in A) in the <code>static_currents.txt</code> file with the subcircuit instance name, subcircuit port name, and the current flowing in the port. This current is distributed to all MOSFET tap devices. No current distribution is done for non-MOSFET tap devices. In that case, these devices are excluded from the block-level based current distribution. The following is an example of the file:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082739"></a>I1 VDD 0.001<br />I1.I2 VDD 0.005<br />I1.I2/I3 VDD 0.00001<br />I1.I2.I3/I4 VDD 0.000005<br />I1 VSS -0.005<br />I1.MPM1@19 VDD 0                //exclude tap device from current assignment<br />I1.MPM3@15 VDD 0.0001           //define tap device current,exclude from current                                   assignment<br />x0.QQ0 VSS 0.1 b&#160;&#160;              //define current for non-MOSFET device and terminal</pre>

<p>
<a id="pgfId-1082740"></a>The accuracy of static EMIR analysis strongly depends on the detailed current information provided in <code>static_ifile</code>. Therefore, it is highly recommended to provide the current consumption for every subcircuit instance.</p>
<p>
<a id="pgfId-1082741"></a>The results of static EMIR analysis are written to the same IR drop and EM current text reports, and into the same EM binary database as dynamic EMIR analysis.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1082742"></a>Only one of static or dynamic EMIR analysis can be performed from the same simulation session, and not both. When you run an static EMIR analysis, all other Spectre FX analyses, such as <code>dc</code> and <code>tran</code> are ignored.</div>
<p>
<a id="pgfId-1082743"></a>Static EMIR analysis can also be applied to designs with power gates. For this, you need to specify the <code>pwrgate</code> option, as follows:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082744"></a>net name=[I1.VDD] analysis=[vavg iavg]</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082745"></a>static ifile=&quot;static_currents.txt&quot; </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082746"></a>net pwrgate=[I1.VDD I1.VDD_INT] analysis=[vavg iavg]</pre>

<p>
<a id="pgfId-1082747"></a>You need to specify the power gate current in the <code>static_currents.txt</code> file, as shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1082748"></a>I1 VDD 0.001<br />I1 VDD_INT 0.0005</pre>

<p>
<a id="pgfId-1082749"></a>The static EMIR current file for the top-level EMIR subcircuit can be generated while running a dynamic EMIR analysis by using the <code>output=power</code> option in the time window statement.</p>

<h2>
<a id="pgfId-1083301"></a><a id="21887"></a>Spectre FX EMIR Analysis Using Voltus-XFi</h2>

<p>
<a id="pgfId-1083302"></a>Voltus-XFi Custom Power Integrity Solution is used for transistor-level power and signal integrity analysis, which includes multi-mode simulation for EM and IR analysis. This solution combines Cadence&#174; Quantusâ„¢ RC extraction, Spectre FX EMIR simulation, and Voltus-XFi visualization in the Cadence Virtuoso&#174; platform. This combination of products simplifies the use model of the flow by using a common setup for all the tools. You do not have to run the flow in separate steps. </p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="probing_measuring.html" id="prev" title="Probing and Measuring Statements">Probing and Measuring Statemen ...</a></em></b><b><em><a href="postlayout_re_Post-layout_Simulation_Methodologies.html" id="nex" title="Post-layout Simulation Methodologies">Post-layout Simulation Methodo ...</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2023, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
 

 <div id="cad_image_modal" style="background-color: rgba(0, 0, 0, 0.6);"><center id="cad_image_modal_center">&#160;â € </center><span style="margin-right:50px;margin-top:100px;font-weight:bold;font-size:20px;background:#e5e5e5;border:1px solid #e5e5e5;border-radius:25px;height:30px;width:20px;padding-left:6px;padding-top:2px;color: black;" onclick="document.querySelector('#cad_image_modal').classList.remove('opac');">X</span></div> 

</body></html>